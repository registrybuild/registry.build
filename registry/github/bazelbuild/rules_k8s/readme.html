<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><h1 dir="auto"><a id="user-content-archived-bazel-kubernetes-rules" class="anchor" aria-hidden="true" tabindex="-1" href="#archived-bazel-kubernetes-rules"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>(ARCHIVED) Bazel Kubernetes Rules</h1>
<p dir="auto"><strong>This repository is no longer maintained.</strong></p>
<table>
<thead>
<tr>
<th align="center">Prow</th>
<th align="center">Bazel CI</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><a href="https://prow.k8s.io/?repo=bazelbuild%2Frules_k8s" rel="nofollow"><img src="https://camo.githubusercontent.com/4871ef303bb8bc38844bba4a8c01ad8b278e640c05284ccc49af263d078cc577/68747470733a2f2f70726f772e6b38732e696f2f62616467652e7376673f6a6f62733d70756c6c2d72756c65732d6b38732d2a" alt="Build status" data-canonical-src="https://prow.k8s.io/badge.svg?jobs=pull-rules-k8s-*" style="max-width: 100%;"></a></td>
<td align="center"><a href="https://buildkite.com/bazel/k8s-rules-k8s-postsubmit" rel="nofollow"><img src="https://camo.githubusercontent.com/88f66e14389e2afa16c4b029fc2214d00a60bc9d35d8069f5d30527fc05e2d02/68747470733a2f2f62616467652e6275696c646b6974652e636f6d2f34656166643362363139623966656261653637396261633463653735623662373436343364343833383465376633366565622e737667" alt="Build status" data-canonical-src="https://badge.buildkite.com/4eafd3b619b9febae679bac4ce75b6b74643d48384e7f36eeb.svg" style="max-width: 100%;"></a></td>
</tr>
</tbody>
</table>
<h2 dir="auto"><a id="user-content-rules" class="anchor" aria-hidden="true" tabindex="-1" href="#rules"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Rules</h2>
<ul dir="auto">
<li><a href="#k8s_defaults">k8s_defaults</a></li>
<li><a href="#k8s_object">k8s_object</a></li>
<li><a href="#k8s_objects">k8s_objects</a></li>
</ul>
<h2 dir="auto"><a id="user-content-overview" class="anchor" aria-hidden="true" tabindex="-1" href="#overview"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Overview</h2>
<p dir="auto">This repository contains rules for interacting with Kubernetes
configurations / clusters.</p>
<h2 dir="auto"><a id="user-content-setup" class="anchor" aria-hidden="true" tabindex="-1" href="#setup"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Setup</h2>
<p dir="auto">Add the following to your <code>WORKSPACE</code> file to add the necessary external dependencies:</p>
<ul dir="auto">
<li>Info for <a href="https://github.com/bazelbuild/rules_docker/#setup">rules_docker</a></li>
</ul>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="load(&quot;@bazel_tools//tools/build_defs/repo:http.bzl&quot;, &quot;http_archive&quot;)

# https://github.com/bazelbuild/rules_docker/#setup
# http_archive(&quot;io_bazel_rules_docker&quot;, ...)

http_archive(
    name = &quot;io_bazel_rules_k8s&quot;,
    strip_prefix = &quot;rules_k8s-0.5&quot;,
    urls = [&quot;https://github.com/bazelbuild/rules_k8s/archive/v0.5.tar.gz&quot;],
    sha256 = &quot;773aa45f2421a66c8aa651b8cecb8ea51db91799a405bd7b913d77052ac7261a&quot;,
)

load(&quot;@io_bazel_rules_k8s//k8s:k8s.bzl&quot;, &quot;k8s_repositories&quot;)

k8s_repositories()

load(&quot;@io_bazel_rules_k8s//k8s:k8s_go_deps.bzl&quot;, k8s_go_deps = &quot;deps&quot;)

k8s_go_deps()"><pre><span class="pl-en">load</span>(<span class="pl-s">"@bazel_tools//tools/build_defs/repo:http.bzl"</span>, <span class="pl-s">"http_archive"</span>)

<span class="pl-c"># https://github.com/bazelbuild/rules_docker/#setup</span>
<span class="pl-c"># http_archive("io_bazel_rules_docker", ...)</span>

<span class="pl-en">http_archive</span>(
    <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"io_bazel_rules_k8s"</span>,
    <span class="pl-s1">strip_prefix</span> <span class="pl-c1">=</span> <span class="pl-s">"rules_k8s-0.5"</span>,
    <span class="pl-s1">urls</span> <span class="pl-c1">=</span> [<span class="pl-s">"https://github.com/bazelbuild/rules_k8s/archive/v0.5.tar.gz"</span>],
    <span class="pl-s1">sha256</span> <span class="pl-c1">=</span> <span class="pl-s">"773aa45f2421a66c8aa651b8cecb8ea51db91799a405bd7b913d77052ac7261a"</span>,
)

<span class="pl-en">load</span>(<span class="pl-s">"@io_bazel_rules_k8s//k8s:k8s.bzl"</span>, <span class="pl-s">"k8s_repositories"</span>)

<span class="pl-en">k8s_repositories</span>()

<span class="pl-en">load</span>(<span class="pl-s">"@io_bazel_rules_k8s//k8s:k8s_go_deps.bzl"</span>, <span class="pl-s1">k8s_go_deps</span> <span class="pl-c1">=</span> <span class="pl-s">"deps"</span>)

<span class="pl-en">k8s_go_deps</span>()</pre></div>
<h2 dir="auto"><a id="user-content-kubernetes-authentication" class="anchor" aria-hidden="true" tabindex="-1" href="#kubernetes-authentication"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Kubernetes Authentication</h2>
<p dir="auto">As is somewhat standard for Bazel, the expectation is that the
<code>kubectl</code> toolchain is preconfigured to authenticate with any clusters
you might interact with.</p>
<p dir="auto">For more information on how to configure <code>kubectl</code> authentication, see the
Kubernetes <a href="https://kubernetes.io/docs/admin/authentication/" rel="nofollow">documentation</a>.</p>
<p dir="auto"><em>NOTE: we are currently experimenting with toolchain features in these rules
so there will be changes upcoming to how this configuration is performed</em></p>
<h3 dir="auto"><a id="user-content-container-engine-authentication" class="anchor" aria-hidden="true" tabindex="-1" href="#container-engine-authentication"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Container Engine Authentication</h3>
<p dir="auto">For Google Container Engine (GKE), the <code>gcloud</code> CLI provides a <a href="https://cloud.google.com/sdk/gcloud/reference/container/clusters/get-credentials" rel="nofollow">simple
command</a>
for setting up authentication:</p>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="gcloud container clusters get-credentials &lt;CLUSTER NAME&gt;"><pre>gcloud container clusters get-credentials <span class="pl-k">&lt;</span>CLUSTER NAME<span class="pl-k">&gt;</span></pre></div>
<p dir="auto"><em>NOTE: we are currently experimenting with toolchain features in these rules
so there will be changes upcoming to how this configuration is performed</em></p>
<h2 dir="auto"><a id="user-content-dependencies" class="anchor" aria-hidden="true" tabindex="-1" href="#dependencies"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Dependencies</h2>
<p dir="auto"><em>New: Starting <a href="https://github.com/bazelbuild/rules_k8s/commit/ff2cbf09ae1f0a9c7ebdfc1fa337044158a7f57b">https://github.com/bazelbuild/rules_k8s/commit/ff2cbf09ae1f0a9c7ebdfc1fa337044158a7f57b</a></em></p>
<p dir="auto">These rules can either use a pre-installed <code>kubectl</code> tool (default) or
build the <code>kubectl</code> tool from sources.</p>
<p dir="auto">The <code>kubectl</code> tool is used when executing the <code>run</code> action from bazel.</p>
<p dir="auto">The <code>kubectl</code> tool is configured via a toolchain rule. Read more about
the kubectl toolchain <a href="toolchains/kubectl#kubectl-toolchain">here</a>.</p>
<p dir="auto">If GKE is used, also the <code>gcloud</code> sdk needs to be installed.</p>
<p dir="auto"><em>NOTE: we are currently experimenting with toolchain features in these rules
so there will be changes upcoming to how this configuration is performed</em></p>
<h2 dir="auto"><a id="user-content-examples" class="anchor" aria-hidden="true" tabindex="-1" href="#examples"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Examples</h2>
<h3 dir="auto"><a id="user-content-basic-deployment-objects" class="anchor" aria-hidden="true" tabindex="-1" href="#basic-deployment-objects"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Basic "deployment" objects</h3>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="load(&quot;@io_bazel_rules_k8s//k8s:object.bzl&quot;, &quot;k8s_object&quot;)

k8s_object(
  name = &quot;dev&quot;,
  kind = &quot;deployment&quot;,

  # A template of a Kubernetes Deployment object yaml.
  template = &quot;:deployment.yaml&quot;,

  # An optional collection of docker_build images to publish
  # when this target is bazel run.  The digest of the published
  # image is substituted as a part of the resolution process.
  images = {
    &quot;gcr.io/rules_k8s/server:dev&quot;: &quot;//server:image&quot;
  },
)"><pre><span class="pl-en">load</span>(<span class="pl-s">"@io_bazel_rules_k8s//k8s:object.bzl"</span>, <span class="pl-s">"k8s_object"</span>)

<span class="pl-en">k8s_object</span>(
  <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"dev"</span>,
  <span class="pl-s1">kind</span> <span class="pl-c1">=</span> <span class="pl-s">"deployment"</span>,

  <span class="pl-c"># A template of a Kubernetes Deployment object yaml.</span>
  <span class="pl-s1">template</span> <span class="pl-c1">=</span> <span class="pl-s">":deployment.yaml"</span>,

  <span class="pl-c"># An optional collection of docker_build images to publish</span>
  <span class="pl-c"># when this target is bazel run.  The digest of the published</span>
  <span class="pl-c"># image is substituted as a part of the resolution process.</span>
  <span class="pl-s1">images</span> <span class="pl-c1">=</span> {
    <span class="pl-s">"gcr.io/rules_k8s/server:dev"</span>: <span class="pl-s">"//server:image"</span>
  },
)</pre></div>
<h3 dir="auto"><a id="user-content-aliasing-eg-k8s_deploy" class="anchor" aria-hidden="true" tabindex="-1" href="#aliasing-eg-k8s_deploy"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Aliasing (e.g. <code>k8s_deploy</code>)</h3>
<p dir="auto">In your <code>WORKSPACE</code> you can set up aliases for a more readable short-hand:</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="load(&quot;@io_bazel_rules_k8s//k8s:k8s.bzl&quot;, &quot;k8s_defaults&quot;)

k8s_defaults(
  # This becomes the name of the @repository and the rule
  # you will import in your BUILD files.
  name = &quot;k8s_deploy&quot;,
  kind = &quot;deployment&quot;,
  # This is the name of the cluster as it appears in:
  #   kubectl config view --minify -o=jsonpath='{.contexts[0].context.cluster}'
  cluster = &quot;my-gke-cluster&quot;,
)"><pre><span class="pl-en">load</span>(<span class="pl-s">"@io_bazel_rules_k8s//k8s:k8s.bzl"</span>, <span class="pl-s">"k8s_defaults"</span>)

<span class="pl-en">k8s_defaults</span>(
  <span class="pl-c"># This becomes the name of the @repository and the rule</span>
  <span class="pl-c"># you will import in your BUILD files.</span>
  <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"k8s_deploy"</span>,
  <span class="pl-s1">kind</span> <span class="pl-c1">=</span> <span class="pl-s">"deployment"</span>,
  <span class="pl-c"># This is the name of the cluster as it appears in:</span>
  <span class="pl-c">#   kubectl config view --minify -o=jsonpath='{.contexts[0].context.cluster}'</span>
  <span class="pl-s1">cluster</span> <span class="pl-c1">=</span> <span class="pl-s">"my-gke-cluster"</span>,
)</pre></div>
<p dir="auto">Then in place of the above, you can use the following in your <code>BUILD</code> file:</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="load(&quot;@k8s_deploy//:defaults.bzl&quot;, &quot;k8s_deploy&quot;)

k8s_deploy(
  name = &quot;dev&quot;,
  template = &quot;:deployment.yaml&quot;,
  images = {
    &quot;gcr.io/rules_k8s/server:dev&quot;: &quot;//server:image&quot;
  },
)"><pre><span class="pl-en">load</span>(<span class="pl-s">"@k8s_deploy//:defaults.bzl"</span>, <span class="pl-s">"k8s_deploy"</span>)

<span class="pl-en">k8s_deploy</span>(
  <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"dev"</span>,
  <span class="pl-s1">template</span> <span class="pl-c1">=</span> <span class="pl-s">":deployment.yaml"</span>,
  <span class="pl-s1">images</span> <span class="pl-c1">=</span> {
    <span class="pl-s">"gcr.io/rules_k8s/server:dev"</span>: <span class="pl-s">"//server:image"</span>
  },
)</pre></div>
<p dir="auto">Note that in <code>load("@k8s_deploy//:defaults.bzl", "k8s_deploy")</code> both <code>k8s_deploy</code>'s are references to the <code>name</code> parameter passed to <code>k8s_defaults</code>. If you change <code>name = "k8s_deploy"</code> to something else, you will need to change the <code>load</code> statement in both places.</p>
<h3 dir="auto"><a id="user-content-multi-object-actions" class="anchor" aria-hidden="true" tabindex="-1" href="#multi-object-actions"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Multi-Object Actions</h3>
<p dir="auto">It is common practice in the Kubernetes world to have multiple objects that
comprise an application.  There are two main ways that we support interacting
with these kinds of objects.</p>
<p dir="auto">The first is to simply use a template file that contains your N objects
delimited with <code>---</code>, and omitting <code>kind="..."</code>.</p>
<p dir="auto">The second is through the use of <code>k8s_objects</code>, which aggregates N <code>k8s_object</code>
rules:</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="# Note the plurality of &quot;objects&quot; here.
load(&quot;@io_bazel_rules_k8s//k8s:objects.bzl&quot;, &quot;k8s_objects&quot;)

k8s_objects(
   name = &quot;deployments&quot;,
   objects = [
      &quot;:foo-deployment&quot;,
      &quot;:bar-deployment&quot;,
      &quot;:baz-deployment&quot;,
   ]
)

k8s_objects(
   name = &quot;services&quot;,
   objects = [
      &quot;:foo-service&quot;,
      &quot;:bar-service&quot;,
      &quot;:baz-service&quot;,
   ]
)

# These rules can be nested
k8s_objects(
   name = &quot;everything&quot;,
   objects = [
      &quot;:deployments&quot;,
      &quot;:services&quot;,
      &quot;:configmaps&quot;,
      &quot;:ingress&quot;,
   ]
)"><pre><span class="pl-c"># Note the plurality of "objects" here.</span>
<span class="pl-en">load</span>(<span class="pl-s">"@io_bazel_rules_k8s//k8s:objects.bzl"</span>, <span class="pl-s">"k8s_objects"</span>)

<span class="pl-en">k8s_objects</span>(
   <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"deployments"</span>,
   <span class="pl-s1">objects</span> <span class="pl-c1">=</span> [
      <span class="pl-s">":foo-deployment"</span>,
      <span class="pl-s">":bar-deployment"</span>,
      <span class="pl-s">":baz-deployment"</span>,
   ]
)

<span class="pl-en">k8s_objects</span>(
   <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"services"</span>,
   <span class="pl-s1">objects</span> <span class="pl-c1">=</span> [
      <span class="pl-s">":foo-service"</span>,
      <span class="pl-s">":bar-service"</span>,
      <span class="pl-s">":baz-service"</span>,
   ]
)

<span class="pl-c"># These rules can be nested</span>
<span class="pl-en">k8s_objects</span>(
   <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"everything"</span>,
   <span class="pl-s1">objects</span> <span class="pl-c1">=</span> [
      <span class="pl-s">":deployments"</span>,
      <span class="pl-s">":services"</span>,
      <span class="pl-s">":configmaps"</span>,
      <span class="pl-s">":ingress"</span>,
   ]
)</pre></div>
<p dir="auto">This can be useful when you want to be able to stand up a full environment,
which includes resources that are expensive to recreate (e.g. LoadBalancer),
but still want to be able to quickly iterate on parts of your application.</p>
<h3 dir="auto"><a id="user-content-developer-environments" class="anchor" aria-hidden="true" tabindex="-1" href="#developer-environments"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Developer Environments</h3>
<p dir="auto">A common practice to avoid clobbering other users is to do your development
against an isolated environment.  Two practices are fairly common-place.</p>
<ol dir="auto">
<li>Individual development clusters</li>
<li>Development "namespaces"</li>
</ol>
<p dir="auto">To support these scenarios, the rules support using "stamping" variables to
customize these arguments to <code>k8s_defaults</code> or <code>k8s_object</code>.</p>
<p dir="auto">For per-developer clusters, you might use:</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="k8s_defaults(
  name = &quot;k8s_dev_deploy&quot;,
  kind = &quot;deployment&quot;,
  cluster = &quot;gke_dev-proj_us-central5-z_{BUILD_USER}&quot;,
)"><pre><span class="pl-en">k8s_defaults</span>(
  <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"k8s_dev_deploy"</span>,
  <span class="pl-s1">kind</span> <span class="pl-c1">=</span> <span class="pl-s">"deployment"</span>,
  <span class="pl-s1">cluster</span> <span class="pl-c1">=</span> <span class="pl-s">"gke_dev-proj_us-central5-z_{BUILD_USER}"</span>,
)</pre></div>
<p dir="auto">For per-developer namespaces, you might use:</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="k8s_defaults(
  name = &quot;k8s_dev_deploy&quot;,
  kind = &quot;deployment&quot;,
  cluster = &quot;shared-cluster&quot;,
  namespace = &quot;{BUILD_USER}&quot;,
)"><pre><span class="pl-en">k8s_defaults</span>(
  <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"k8s_dev_deploy"</span>,
  <span class="pl-s1">kind</span> <span class="pl-c1">=</span> <span class="pl-s">"deployment"</span>,
  <span class="pl-s1">cluster</span> <span class="pl-c1">=</span> <span class="pl-s">"shared-cluster"</span>,
  <span class="pl-s1">namespace</span> <span class="pl-c1">=</span> <span class="pl-s">"{BUILD_USER}"</span>,
)</pre></div>
<p dir="auto">You can customize the stamp variables that are available at a repository level
by leveraging <code>--workspace_status_command</code>.  One pattern for this is to check in
the following:</p>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="$ cat .bazelrc
build --workspace_status_command=&quot;bash ./print-workspace-status.sh&quot;

$ cat print-workspace-status.sh
cat &lt;&lt;EOF
VAR1 value1
# This can be overriden by users if they &quot;export VAR2_OVERRIDE&quot;
VAR2 ${VAR2_OVERRIDE:-default-value2}
EOF"><pre>$ cat .bazelrc
build --workspace_status_command=<span class="pl-s"><span class="pl-pds">"</span>bash ./print-workspace-status.sh<span class="pl-pds">"</span></span>

$ cat print-workspace-status.sh
cat <span class="pl-s"><span class="pl-k">&lt;&lt;</span><span class="pl-k">EOF</span></span>
<span class="pl-s">VAR1 value1</span>
<span class="pl-s"># This can be overriden by users if they "export VAR2_OVERRIDE"</span>
<span class="pl-s">VAR2 <span class="pl-smi">${VAR2_OVERRIDE<span class="pl-k">:-</span>default-value2}</span></span>
<span class="pl-s"><span class="pl-k">EOF</span></span></pre></div>
<p dir="auto">For more information on "stamping", you can see also the <code>rules_docker</code>
documentation on stamping <a href="https://github.com/bazelbuild/rules_docker#stamping">here</a>.</p>
<h4 dir="auto"><a id="user-content-dont-tread-on-my-tags" class="anchor" aria-hidden="true" tabindex="-1" href="#dont-tread-on-my-tags"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Don't tread on my tags</h4>
<p dir="auto">Another ugly problem remains, which is that image references are still
shared across developers, and while our resolution to digests avoids races, we
may not want them trampling on the same tag, or on production tags if shared
templates are being used.</p>
<p dir="auto">Moreover, developers may not have access to push to the images referenced in a
particular template, or the development cluster to which they are deploying may
not be able to pull them (e.g. clusters in different GCP projects).</p>
<p dir="auto">To resolve this, we enable developers to "chroot" the image references,
publishing them instead to that reference under another repository.</p>
<p dir="auto">Consider the following, where developers use GCP projects named
<code>company-{BUILD_USER}</code>:</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="k8s_defaults(
  name = &quot;k8s_dev_deploy&quot;,
  kind = &quot;deployment&quot;,
  cluster = &quot;gke_company-{BUILD_USER}_us-central5-z_da-cluster&quot;,
  image_chroot = &quot;us.gcr.io/company-{BUILD_USER}/dev&quot;,
)"><pre><span class="pl-en">k8s_defaults</span>(
  <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"k8s_dev_deploy"</span>,
  <span class="pl-s1">kind</span> <span class="pl-c1">=</span> <span class="pl-s">"deployment"</span>,
  <span class="pl-s1">cluster</span> <span class="pl-c1">=</span> <span class="pl-s">"gke_company-{BUILD_USER}_us-central5-z_da-cluster"</span>,
  <span class="pl-s1">image_chroot</span> <span class="pl-c1">=</span> <span class="pl-s">"us.gcr.io/company-{BUILD_USER}/dev"</span>,
)</pre></div>
<p dir="auto">In this example, the <code>k8s_dev_deploy</code> rules will target the developer's cluster
in their project, and images will all be published under the <code>image_chroot</code>.</p>
<p dir="auto">For example, if the BUILD file contains:</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="k8s_deploy(
  name = &quot;dev&quot;,
  template = &quot;:deployment.yaml&quot;,
  images = {
    &quot;gcr.io/rules_k8s/server:dev&quot;: &quot;//server:image&quot;
  },
)"><pre><span class="pl-en">k8s_deploy</span>(
  <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"dev"</span>,
  <span class="pl-s1">template</span> <span class="pl-c1">=</span> <span class="pl-s">":deployment.yaml"</span>,
  <span class="pl-s1">images</span> <span class="pl-c1">=</span> {
    <span class="pl-s">"gcr.io/rules_k8s/server:dev"</span>: <span class="pl-s">"//server:image"</span>
  },
)</pre></div>
<p dir="auto">Then the references to <code>gcr.io/rules_k8s/server:dev</code> will be replaced with one
to: <code>us.gcr.io/company-{BUILD_USER}/dev/gcr.io/rules_k8s/server@sha256:...</code>.</p>
<h3 dir="auto"><a id="user-content-custom-resolvers" class="anchor" aria-hidden="true" tabindex="-1" href="#custom-resolvers"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Custom resolvers</h3>
<p dir="auto">Sometimes, you need to replace additional runtime parameters in the YAML file.
While you can use <code>expand_template</code> for parameters known to the build system,
you'll need a custom resolver if the parameter is determined at deploy time.
A common example is Google Cloud Endpoints service versions, which are
determined by the server.</p>
<p dir="auto">You can pass a custom resolver executable as the <code>resolver</code> argument of all
rules:</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="sh_binary(
  name = &quot;my_script&quot;,
  ...
)

k8s_deploy(
  name = &quot;dev&quot;
  template = &quot;:deployment.yaml&quot;,
  images = {
    &quot;gcr.io/rules_k8s/server:dev&quot;: &quot;//server:image&quot;
  },
  resolver = &quot;//my_script&quot;,
)"><pre><span class="pl-en">sh_binary</span>(
  <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"my_script"</span>,
  ...
)

<span class="pl-en">k8s_deploy</span>(
  <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"dev"</span>
  <span class="pl-s1">template</span> <span class="pl-c1">=</span> <span class="pl-s">":deployment.yaml"</span>,
  <span class="pl-s1">images</span> <span class="pl-c1">=</span> {
    <span class="pl-s">"gcr.io/rules_k8s/server:dev"</span>: <span class="pl-s">"//server:image"</span>
  },
  <span class="pl-s1">resolver</span> <span class="pl-c1">=</span> <span class="pl-s">"//my_script"</span>,
)</pre></div>
<p dir="auto">This script may need to invoke the default resolver (<code>//k8s/go/cmd/resolver</code>) with all
its arguments. It may capture the default resolver's output and apply additional
modifications to the YAML, printing the final YAML to stdout.</p>
<h2 dir="auto"><a id="user-content-usage" class="anchor" aria-hidden="true" tabindex="-1" href="#usage"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Usage</h2>
<p dir="auto">The <code>k8s_object[s]</code> rules expose a collection of actions.  We will follow the <code>:dev</code>
target from the example above.</p>
<h3 dir="auto"><a id="user-content-build" class="anchor" aria-hidden="true" tabindex="-1" href="#build"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Build</h3>
<p dir="auto">Build builds all of the constituent elements, and makes the template available
as <code>{name}.yaml</code>.  If <code>template</code> is a generated input, it will be built.
Likewise, any <code>docker_build</code> images referenced from the <code>images={}</code> attribute
will be built.</p>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="bazel build :dev"><pre>bazel build :dev</pre></div>
<h3 dir="auto"><a id="user-content-resolve" class="anchor" aria-hidden="true" tabindex="-1" href="#resolve"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Resolve</h3>
<p dir="auto">Deploying with tags, especially in production, is a bad practice because they
are mutable.  If a tag changes, it can lead to inconsistent versions of your app
running after auto-scaling or auto-healing events.  Thankfully in v2 of the
Docker Registry, digests were introduced.  Deploying by digest provides
cryptographic guarantees of consistency across the replicas of a deployment.</p>
<p dir="auto">You can "resolve" your resource <code>template</code> by running:</p>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="bazel run :dev"><pre>bazel run :dev</pre></div>
<p dir="auto">The resolved <code>template</code> will be printed to <code>STDOUT</code>.</p>
<p dir="auto">This command will publish any <code>images = {}</code> present in your rule, substituting
those exact digests into the yaml template, and for other images resolving the
tags to digests by reaching out to the appropriate registry.  Any images that
cannot be found or accessed are left unresolved.</p>
<p dir="auto"><strong>This process only supports fully-qualified tag names.</strong>  This means you must
always specify tag and registry domain names (no implicit <code>:latest</code>).</p>
<h3 dir="auto"><a id="user-content-create" class="anchor" aria-hidden="true" tabindex="-1" href="#create"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Create</h3>
<p dir="auto">Users can create an environment by running:</p>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="bazel run :dev.create"><pre>bazel run :dev.create</pre></div>
<p dir="auto">This deploys the <strong>resolved</strong> template, which includes publishing images.</p>
<h3 dir="auto"><a id="user-content-update" class="anchor" aria-hidden="true" tabindex="-1" href="#update"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Update</h3>
<p dir="auto">Users can update (replace) their environment by running:</p>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="bazel run :dev.replace"><pre>bazel run :dev.replace</pre></div>
<p dir="auto">Like <code>.create</code> this deploys the <strong>resolved</strong> template, which includes
republishing images.  <strong>This action is intended to be the workhorse
of fast-iteration development</strong> (rebuilding / republishing / redeploying).</p>
<h3 dir="auto"><a id="user-content-apply" class="anchor" aria-hidden="true" tabindex="-1" href="#apply"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Apply</h3>
<p dir="auto">Users can "apply" a configuration by running:</p>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="bazel run :dev.apply"><pre>bazel run :dev.apply</pre></div>
<p dir="auto"><code>:dev.apply</code> maps to <code>kubectl apply</code>, which will create or replace an existing
configuration.  For more information see the <code>kubectl</code> documentation.</p>
<p dir="auto">This applies the <strong>resolved</strong> template, which includes republishing images.
<strong>This action is intended to be the workhorse of fast-iteration development</strong>
(rebuilding / republishing / redeploying).</p>
<h3 dir="auto"><a id="user-content-delete" class="anchor" aria-hidden="true" tabindex="-1" href="#delete"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Delete</h3>
<p dir="auto">Users can tear down their environment by running:</p>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="bazel run :dev.delete"><pre>bazel run :dev.delete</pre></div>
<p dir="auto">It is notable that despite deleting the deployment, this will NOT delete
any services currently load balancing over the deployment; this is intentional
as creating load balancers can be slow.</p>
<h3 dir="auto"><a id="user-content-describe-k8s_object-only" class="anchor" aria-hidden="true" tabindex="-1" href="#describe-k8s_object-only"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Describe (<code>k8s_object</code>-only)</h3>
<p dir="auto">Users can "describe" their environment by running:</p>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="bazel run :dev.describe"><pre>bazel run :dev.describe</pre></div>
<h3 dir="auto"><a id="user-content-diff" class="anchor" aria-hidden="true" tabindex="-1" href="#diff"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Diff</h3>
<p dir="auto">Users can "diff" a configuration by running:</p>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="bazel run :dev.diff"><pre>bazel run :dev.diff</pre></div>
<p dir="auto"><code>:dev.diff</code> maps to <code>kubectl diff</code>, which will diff the live against the would-be applied version.
For more information see the <code>kubectl</code> documentation.</p>
<p dir="auto">This diffs the <strong>resolved</strong> template, but does not include republishing images.</p>
<p dir="auto"><a name="user-content-k8s_object"></a></p>
<h2 dir="auto"><a id="user-content-k8s_object" class="anchor" aria-hidden="true" tabindex="-1" href="#k8s_object"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>k8s_object</h2>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="k8s_object(name, kind, template)"><pre><span class="pl-en">k8s_object</span>(<span class="pl-s1">name</span>, <span class="pl-s1">kind</span>, <span class="pl-s1">template</span>)</pre></div>
<p dir="auto">A rule for interacting with Kubernetes objects.</p>
<p dir="auto"></p><table>
  
    
    
  
  <thead>
    <tr>
      <th colspan="2">Attributes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>name</code></td>
      <td>
        <p dir="auto"><code>Name, required</code></p>
        <p dir="auto">Unique name for this rule.</p>
      </td>
    </tr>
    <tr>
      <td><code>kind</code></td>
      <td>
        <p dir="auto"><code>Kind, required</code></p>
        <p dir="auto">The kind of the Kubernetes object in the yaml.</p>
        <p dir="auto"><b>If this is omitted, the <code>apply, create, replace, delete,
          describe</code> actions will not exist.</b></p>
      </td>
    </tr>
    <tr>
      <td><code>cluster</code></td>
      <td>
        <p dir="auto"><code>string, optional</code></p>
        <p dir="auto">The name of the cluster to which <code>create, replace, delete,
          describe</code> should speak. Subject to "Make" variable substitution.</p>
        <p dir="auto"><b>If this is omitted, the <code>apply, create, replace, delete,
          describe</code> actions will not exist.</b></p>
      </td>
    </tr>
    <tr>
      <td><code>context</code></td>
      <td>
        <p dir="auto"><code>string, optional</code></p>
        <p dir="auto">The name of a kubeconfig context to use. Subject to "Make" variable
          substitution.</p>
        <p dir="auto"><b>If this is omitted, the current context will be used.</b></p>
      </td>
    </tr>
    <tr>
      <td><code>namespace</code></td>
      <td>
        <p dir="auto"><code>string, optional</code></p>
        <p dir="auto">The namespace on the cluster within which the actions are
          performed. Subject to "Make" variable substitution.</p>
        <p dir="auto"><b>If this is omitted, it will default to the value specified
          in the template or if also unspecified there, to the value
          <code>"default"</code>.</b></p>
      </td>
    </tr>
    <tr>
      <td><code>user</code></td>
      <td>
        <p dir="auto"><code>string, optional</code></p>
        <p dir="auto">The user to authenticate to the cluster as configured with kubectl.
          Subject to "Make" variable substitution.</p>
        <p dir="auto"><b>If this is omitted, kubectl will authenticate as the user from the
          current context.</b></p>
      </td>
    </tr>
    <tr>
      <td><code>kubeconfig</code></td>
      <td>
        <p dir="auto"><code>kubeconfig file, optional</code></p>
        <p dir="auto">The kubeconfig file to pass to the `kubectl` tool via the
          `--kubeconfig` option. Can be useful if the `kubeconfig` is generated
          by another target.</p>
      </td>
    </tr>
    <tr>
      <td><code>substitutions</code></td>
      <td>
        <p dir="auto"><code>string_dict, optional</code></p>
        <p dir="auto">Substitutions to make when expanding the template.</p>
        <p dir="auto">Follows the same rules as
          <a href="https://docs.bazel.build/versions/master/skylark/lib/actions.html#expand_template" rel="nofollow">expand_template</a>
          Values are <a href="https://docs.bazel.build/versions/master/be/make-variables.html" rel="nofollow">"make variable substituted."</a>
          You can also use the Bazel command line option <code>--define</code>
          to define your own custom variables.
        </p>
        <p dir="auto"></p><pre>  # Example
  k8s_object(
    name = "my_ingress",
    kind = "ingress",
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="# A template of a Kubernetes ingress object yaml.
template = &quot;:ingress.yaml&quot;,

# An optional collection of docker_build images to publish
# when this target is bazel run.  The digest of the published
# image is substituted as a part of the resolution process.
substitutions = {
  &quot;%{expand_template_variable}&quot;: &quot;$(make_expanded_variable}&quot;,
})"><pre class="notranslate"><code># A template of a Kubernetes ingress object yaml.
template = ":ingress.yaml",

# An optional collection of docker_build images to publish
# when this target is bazel run.  The digest of the published
# image is substituted as a part of the resolution process.
substitutions = {
  "%{expand_template_variable}": "$(make_expanded_variable}",
})
</code></pre></div>
<p dir="auto"></p></pre><p dir="auto"></p>
<p dir="auto">Which is then invoked with <code>bazel run --define make_expanded_variable=value :target</code>
and will replace any occurrences of the literal token <code>%{expand_template_variable}</code> in your
template with the value "value" by way of first make variable
substitution and then string replacement.
</p>
<p dir="auto">Any stamp variables are also replaced with their values. This is done
after make variable substitution.</p>
</td>
</tr>
<tr>
<td><code>template</code></td>
<td>
<p dir="auto"><code>yaml or json file; required</code></p>
<p dir="auto">The yaml or json for a Kubernetes object.</p>
</td>
</tr>
<tr>
<td><code>images</code></td>
<td>
<p dir="auto"><code>string to label dictionary</code></p>
<p dir="auto">When this target is <code>bazel run</code> the images
referenced by label will be published to the tag key.</p>
<p dir="auto">The published digests of these images will be substituted
directly, so as to avoid a race in the resolution process</p>
<p dir="auto">Subject to "Make" variable substitution</p>
</td>
</tr>
<tr>
<td><code>image_chroot</code></td>
<td>
<p dir="auto"><code>string, optional</code></p>
<p dir="auto">The repository under which to actually publish Docker images.</p>
</td>
</tr>
<tr>
<td><code>resolver</code></td>
<td>
<p dir="auto"><code>target, optional</code></p>
<p dir="auto">A build target for the binary that's called to resolves references
inside the Kubernetes YAML files.</p>
</td>
</tr>
<tr>
<td><code>args</code></td>
<td>
<p dir="auto"><code>string_list, optional</code></p>
<p dir="auto">Additional arguments to pass to the kubectl command at execution.</p>
<p dir="auto">NOTE: You can also pass args via the cli by run something like:
<code>bazel run some_target -- some_args</code></p>
<p dir="auto">NOTE: Not all options are available for all kubectl commands. To view the list of global options run: <code>kubectl options</code></p>
</td>
</tr>
<tr>
<td><code>resolver_args</code></td>
<td>
<p dir="auto"><code>string_list, optional</code></p>
<p dir="auto">Additional arguments to pass to the resolver directly.</p>
<p dir="auto">NOTE: This option is to pass the specific arguments to the resolver directly, such as <code>--allow_unused_images</code>.</p>
</td>
</tr>
  </tbody>
</table>
<p dir="auto"><a name="user-content-k8s_objects"></a></p>
<h2 dir="auto"><a id="user-content-k8s_objects" class="anchor" aria-hidden="true" tabindex="-1" href="#k8s_objects"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>k8s_objects</h2>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="k8s_objects(name, objects)"><pre><span class="pl-en">k8s_objects</span>(<span class="pl-s1">name</span>, <span class="pl-s1">objects</span>)</pre></div>
<p dir="auto">A rule for interacting with multiple Kubernetes objects.</p>
<table>
  
    
    
  
  <thead>
    <tr>
      <th colspan="2">Attributes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>name</code></td>
      <td>
        <p dir="auto"><code>Name, required</code></p>
        <p dir="auto">Unique name for this rule.</p>
      </td>
    </tr>
    <tr>
      <td><code>objects</code></td>
      <td>
        <p dir="auto"><code>Label list or dict; required</code></p>
        <p dir="auto">The list of objects on which actions are taken.</p>
	<p dir="auto">When <code>bazel run</code> this target resolves each of the object
	   targets which includes publishing their associated images, and will
	   print a <code>---</code> delimited yaml.</p>
        <p dir="auto"> If a dict is provided it will be converted to a <a href="https://docs.bazel.build/versions/master/be/functions.html" rel="nofollow">select</a> statement.</p>
      </td>
    </tr>
  </tbody>
</table>
<p dir="auto"><a name="user-content-k8s_defaults"></a></p>
<h2 dir="auto"><a id="user-content-k8s_defaults" class="anchor" aria-hidden="true" tabindex="-1" href="#k8s_defaults"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>k8s_defaults</h2>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="k8s_defaults(name, kind)"><pre><span class="pl-en">k8s_defaults</span>(<span class="pl-s1">name</span>, <span class="pl-s1">kind</span>)</pre></div>
<p dir="auto">A repository rule that allows users to alias <code>k8s_object</code> with default values.</p>
<table>
  
    
    
  
  <thead>
    <tr>
      <th colspan="2">Attributes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>name</code></td>
      <td>
        <p dir="auto"><code>Name, required</code></p>
        <p dir="auto">The name of the repository that this rule will create.</p>
        <p dir="auto">Also the name of rule imported from
          <code>@name//:defaults.bzl</code></p>
      </td>
    </tr>
    <tr>
      <td><code>kind</code></td>
      <td>
        <p dir="auto"><code>Kind, optional</code></p>
        <p dir="auto">The kind of objects the alias of <code>k8s_object</code> handles.</p>
      </td>
    </tr>
    <tr>
      <td><code>cluster</code></td>
      <td>
        <p dir="auto"><code>string, optional</code></p>
        <p dir="auto">The name of the cluster to which <code>create, replace, delete,
           describe</code> should speak.</p>
	<p dir="auto">This should match the cluster name as it would appear in
           <code>kubectl config view --minify -o=jsonpath='{.contexts[0].context.cluster}'</code></p>
      </td>
    </tr>
    <tr>
      <td><code>context</code></td>
      <td>
        <p dir="auto"><code>string, optional</code></p>
        <p dir="auto">The name of a kubeconfig context to use.</p>
      </td>
    </tr>
    <tr>
      <td><code>namespace</code></td>
      <td>
        <p dir="auto"><code>string, optional</code></p>
        <p dir="auto">The namespace on the cluster within which the actions are
           performed.</p>
      </td>
    </tr>
    <tr>
      <td><code>user</code></td>
      <td>
        <p dir="auto"><code>string, optional</code></p>
        <p dir="auto">The user to authenticate to the cluster as configured with kubectl.</p>
      </td>
    </tr>
    <tr>
      <td><code>image_chroot</code></td>
      <td>
        <p dir="auto"><code>string, optional</code></p>
        <p dir="auto">The repository under which to actually publish Docker images.</p>
      </td>
    </tr>
    <tr>
      <td><code>resolver</code></td>
      <td>
        <p dir="auto"><code>target, optional</code></p>
        <p dir="auto">A build target for the binary that's called to resolves references
           inside the Kubernetes YAML files.</p>
      </td>
    </tr>
  </tbody>
</table>
<h2 dir="auto"><a id="user-content-testing" class="anchor" aria-hidden="true" tabindex="-1" href="#testing"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Testing</h2>
<p dir="auto">To test rules_k8s, you can run the provided e2e tests locally on Linux by
following these <a href="examples/#running-rules_k8s-e2e-tests-locally">instructions</a>.</p>
<h2 dir="auto"><a id="user-content-support" class="anchor" aria-hidden="true" tabindex="-1" href="#support"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Support</h2>
<p dir="auto">Users find on stackoverflow, slack and Google Group mailing list.</p>
<h3 dir="auto"><a id="user-content-stackoverflow" class="anchor" aria-hidden="true" tabindex="-1" href="#stackoverflow"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Stackoverflow</h3>
<p dir="auto">Stackoverflow is a great place for developers to help each other.</p>
<p dir="auto">Search through <a href="https://stackoverflow.com/search?q=rules_k8s" rel="nofollow">existing questions</a> to see if someone else has had the same issue as you.</p>
<p dir="auto">If you have a new question, please [ask] the stackoverflow community. Include <code>rules_k8s</code> in the title and add <code>[bazel]</code> and <code>[kubernetes]</code> tags.</p>
<h3 dir="auto"><a id="user-content-google-group-mailing-list" class="anchor" aria-hidden="true" tabindex="-1" href="#google-group-mailing-list"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Google group mailing list</h3>
<p dir="auto">The general <a href="https://bazel.build/support.html" rel="nofollow">bazel support</a> options links to the official <a href="https://groups.google.com/forum/#!forum/bazel-discuss" rel="nofollow">bazel-discuss</a> Google group mailing list.</p>
<h3 dir="auto"><a id="user-content-slack-and-irc" class="anchor" aria-hidden="true" tabindex="-1" href="#slack-and-irc"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Slack and IRC</h3>
<p dir="auto">Slack and IRC are great places for developers to chat with each other.</p>
<p dir="auto">There is a <code>#bazel</code> channel in the kubernetes slack. Visit the <a href="https://kubernetes.io/community/" rel="nofollow">kubernetes community</a> page to find the <a href="http://slack.k8s.io/" rel="nofollow">slack.k8s.io</a> invitation link.</p>
<p dir="auto">There is also a <code>#bazel</code> channel on <a href="https://freenode.net/" rel="nofollow">Freenode IRC</a>, although we have found the slack channel more engaging.</p>
<h2 dir="auto"><a id="user-content-adopters" class="anchor" aria-hidden="true" tabindex="-1" href="#adopters"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Adopters</h2>
<p dir="auto">Here's a (non-exhaustive) list of companies that use <code>rules_k8s</code> in production. Don't see yours? <a href="https://github.com/bazelbuild/rules_k8s/edit/master/README.md">You can add it in a PR!</a></p>
<ul dir="auto">
<li><a href="https://www.etsy.com" rel="nofollow">Etsy</a></li>
<li><a href="https://www.jetstack.io/" rel="nofollow">Jetstack</a></li>
<li><a href="https://github.com/kubernetes/test-infra/tree/master/prow">Prow</a></li>
<li><a href="https://tink.com/" rel="nofollow">Tink</a></li>
<li><a href="https://cookies.co/" rel="nofollow">Cookies</a></li>
</ul>
</article></div>