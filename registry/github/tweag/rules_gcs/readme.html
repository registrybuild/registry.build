<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><div class="markdown-heading" dir="auto"><h1 class="heading-element" dir="auto">rules_gcs</h1><a id="user-content-rules_gcs" class="anchor" aria-label="Permalink: rules_gcs" href="#rules_gcs"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Bazel rules for downloading files from <a href="https://cloud.google.com/storage" rel="nofollow">Google Cloud Storage (GCS)</a>.</p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Features</h2><a id="user-content-features" class="anchor" aria-label="Permalink: Features" href="#features"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li>Can be used as a drop-in replacement for <code>http_file</code> (<code>gcs_file</code>) and <code>http_archive</code> (<code>gcs_archive</code>)</li>
<li>Can fetch large amounts of objects lazily from a bucket using the <code>gcs_bucket</code> module extension</li>
<li>Supports fetching from private buckets using a credential helper</li>
<li>Uses Bazel's downloader and the repository cache</li>
<li>No dependencies like <code>gsutil</code> need to be installed<sup><a href="#user-content-fn-1-bf8a993e765fb7836c6fd8c0156b482c" id="user-content-fnref-1-bf8a993e765fb7836c6fd8c0156b482c" data-footnote-ref="" aria-describedby="footnote-label">1</a></sup></li>
</ul>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Installation</h2><a id="user-content-installation" class="anchor" aria-label="Permalink: Installation" href="#installation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">You can find the latest version of <a href="https://registry.bazel.build/modules/rules_gcs" rel="nofollow"><code>rules_gcs</code> on the Bazel Central Registry</a>. Installation works by adding a <code>bazel_dep</code> line to <code>MODULE.bazel</code>.</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="bazel_dep(name = &quot;rules_gcs&quot;, version = &quot;1.0.1&quot;)"><pre><span class="pl-en">bazel_dep</span>(<span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"rules_gcs"</span>, <span class="pl-s1">version</span> <span class="pl-c1">=</span> <span class="pl-s">"1.0.1"</span>)</pre></div>
<p dir="auto">Additionally, you need to configure a credential helper for <code>storage.googleapis.com</code>. We give you two options:</p>
<p dir="auto">The recommended credential helper is <a href="https://github.com/tweag/credential-helper"><code>tweag-credential-helper</code></a>. The project README will guide you through the required setup. An example is also provided <a href="/examples/tweag-credential-helper">here</a>.</p>
<details>
<summary>
Alternatively, you can use a small bash script that depends on <code>gcloud</code>. Please note that this method can lead to individual downloads taking a long time, since <code>gcloud</code> will not cache credentials on its own (and some authentication flows are slow).
</summary>
<p dir="auto">Add the credential helper shell script to your own repository or install it in the <code>$PATH</code>:</p>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="mkdir -p tools
wget -O tools/credential-helper https://raw.githubusercontent.com/tweag/rules_gcs/main/tools/credential-helper
chmod +x tools/credential-helper"><pre>mkdir -p tools
wget -O tools/credential-helper https://raw.githubusercontent.com/tweag/rules_gcs/main/tools/credential-helper
chmod +x tools/credential-helper</pre></div>
<p dir="auto">Bazel needs to be configured to use the credential helper for the Google Cloud Storage domain <code>storage.googleapis.com</code> in <code>.bazelrc</code>:</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="common --credential_helper=storage.googleapis.com=%workspace%/tools/credential-helper

# recommended optimization
common --experimental_repository_cache_hardlinks"><pre class="notranslate"><code>common --credential_helper=storage.googleapis.com=%workspace%/tools/credential-helper

# recommended optimization
common --experimental_repository_cache_hardlinks
</code></pre></div>
<p dir="auto">It is important to limit the scope of the credential helper to that domain, since it does not yet support parsing of the requested uri.</p>
</details>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Usage</h2><a id="user-content-usage" class="anchor" aria-label="Permalink: Usage" href="#usage"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><code>rules_gcs</code> offers two repository rules <a href="#gcs_file"><code>gcs_file</code></a> and <a href="#gcs_archive"><code>gcs_archive</code></a> for fetching individual objects.
If you need to download multiple objects from a bucket, use the <a href="#gcs_bucket"><code>gcs_bucket</code></a> module extension instead.</p>
<p dir="auto">To see how it all comes together, take a look at the <a href="/examples/full/">full example</a>.</p>
<p dir="auto"><a id="user-content-gcs_archive"></a></p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">gcs_archive</h2><a id="user-content-gcs_archive" class="anchor" aria-label="Permalink: gcs_archive" href="#gcs_archive"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<pre>load("@rules_gcs//gcs:repo_rules.bzl", "gcs_archive")

gcs_archive(<a href="#gcs_archive-name">name</a>, <a href="#gcs_archive-build_file">build_file</a>, <a href="#gcs_archive-build_file_content">build_file_content</a>, <a href="#gcs_archive-canonical_id">canonical_id</a>, <a href="#gcs_archive-integrity">integrity</a>, <a href="#gcs_archive-patch_strip">patch_strip</a>, <a href="#gcs_archive-patches">patches</a>,
            <a href="#gcs_archive-rename_files">rename_files</a>, <a href="#gcs_archive-repo_mapping">repo_mapping</a>, <a href="#gcs_archive-sha256">sha256</a>, <a href="#gcs_archive-strip_prefix">strip_prefix</a>, <a href="#gcs_archive-type">type</a>, <a href="#gcs_archive-url">url</a>)
</pre>
<p dir="auto">Downloads a Bazel repository as a compressed archive file from a GCS bucket, decompresses it,
and makes its targets available for binding.</p>
<p dir="auto">It supports the following file extensions: <code>"zip"</code>, <code>"jar"</code>, <code>"war"</code>, <code>"aar"</code>, <code>"tar"</code>,
<code>"tar.gz"</code>, <code>"tgz"</code>, <code>"tar.xz"</code>, <code>"txz"</code>, <code>"tar.zst"</code>, <code>"tzst"</code>, <code>tar.bz2</code>, <code>"ar"</code>,
or <code>"deb"</code>.</p>
<p dir="auto">Examples:
Suppose your code depends on a private library packaged as a <code>.tar.gz</code>
which is available from gs://my_org_code/libmagic.tar.gz. This <code>.tar.gz</code> file
contains the following directory structure:</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="MODULE.bazel
src/
  magic.cc
  magic.h"><pre class="notranslate"><code>MODULE.bazel
src/
  magic.cc
  magic.h
</code></pre></div>
<p dir="auto">In the local repository, the user creates a <code>magic.BUILD</code> file which
contains the following target definition:</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="cc_library(
    name = &quot;lib&quot;,
    srcs = [&quot;src/magic.cc&quot;],
    hdrs = [&quot;src/magic.h&quot;],
)"><pre><span class="pl-en">cc_library</span>(
    <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"lib"</span>,
    <span class="pl-s1">srcs</span> <span class="pl-c1">=</span> [<span class="pl-s">"src/magic.cc"</span>],
    <span class="pl-s1">hdrs</span> <span class="pl-c1">=</span> [<span class="pl-s">"src/magic.h"</span>],
)</pre></div>
<p dir="auto">Targets in the main repository can depend on this target if the
following lines are added to <code>MODULE.bazel</code>:</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="gcs_archive = use_repo_rule(&quot;@rules_gcs//gcs:repo_rules.bzl&quot;, &quot;gcs_archive&quot;)

gcs_archive(
    name = &quot;magic&quot;,
    url = &quot;gs://my_org_code/libmagic.tar.gz&quot;,
    sha256 = &quot;e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855&quot;,
    build_file = &quot;@//:magic.BUILD&quot;,
)"><pre><span class="pl-s1">gcs_archive</span> <span class="pl-c1">=</span> <span class="pl-en">use_repo_rule</span>(<span class="pl-s">"@rules_gcs//gcs:repo_rules.bzl"</span>, <span class="pl-s">"gcs_archive"</span>)

<span class="pl-en">gcs_archive</span>(
    <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"magic"</span>,
    <span class="pl-s1">url</span> <span class="pl-c1">=</span> <span class="pl-s">"gs://my_org_code/libmagic.tar.gz"</span>,
    <span class="pl-s1">sha256</span> <span class="pl-c1">=</span> <span class="pl-s">"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"</span>,
    <span class="pl-s1">build_file</span> <span class="pl-c1">=</span> <span class="pl-s">"@//:magic.BUILD"</span>,
)</pre></div>
<p dir="auto">Then targets would specify <code>@magic//:lib</code> as a dependency.</p>
<p dir="auto"><strong>ATTRIBUTES</strong></p>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th align="left">Name</th>
<th align="left">Description</th>
<th align="left">Type</th>
<th align="left">Mandatory</th>
<th align="left">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><a id="user-content-gcs_archive-name"></a>name</td>
<td align="left">A unique name for this repository.</td>
<td align="left"><a href="https://bazel.build/concepts/labels#target-names" rel="nofollow">Name</a></td>
<td align="left">required</td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><a id="user-content-gcs_archive-build_file"></a>build_file</td>
<td align="left">The file to use as the BUILD file for this repository.This attribute is an absolute label (use '@//' for the main repo). The file does not need to be named BUILD, but can be (something like BUILD.new-repo-name may work well for distinguishing it from the repository's actual BUILD files. Either build_file or build_file_content can be specified, but not both.</td>
<td align="left"><a href="https://bazel.build/concepts/labels" rel="nofollow">Label</a></td>
<td align="left">optional</td>
<td align="left"><code>None</code></td>
</tr>
<tr>
<td align="left"><a id="user-content-gcs_archive-build_file_content"></a>build_file_content</td>
<td align="left">The content for the BUILD file for this repository. Either build_file or build_file_content can be specified, but not both.</td>
<td align="left">String</td>
<td align="left">optional</td>
<td align="left"><code>""</code></td>
</tr>
<tr>
<td align="left"><a id="user-content-gcs_archive-canonical_id"></a>canonical_id</td>
<td align="left">A canonical ID of the file downloaded.<br><br>If specified and non-empty, Bazel will not take the file from cache, unless it was added to the cache by a request with the same canonical ID.<br><br>If unspecified or empty, Bazel by default uses the URLs of the file as the canonical ID. This helps catch the common mistake of updating the URLs without also updating the hash, resulting in builds that succeed locally but fail on machines without the file in the cache.</td>
<td align="left">String</td>
<td align="left">optional</td>
<td align="left"><code>""</code></td>
</tr>
<tr>
<td align="left"><a id="user-content-gcs_archive-integrity"></a>integrity</td>
<td align="left">Expected checksum in Subresource Integrity format of the file downloaded.<br><br>This must match the checksum of the file downloaded. It is a security risk to omit the checksum as remote files can change. At best omitting this field will make your build non-hermetic. It is optional to make development easier but either this attribute or <code>sha256</code> should be set before shipping.</td>
<td align="left">String</td>
<td align="left">optional</td>
<td align="left"><code>""</code></td>
</tr>
<tr>
<td align="left"><a id="user-content-gcs_archive-patch_strip"></a>patch_strip</td>
<td align="left">Strip the specified number of leading components from file names.</td>
<td align="left">Integer</td>
<td align="left">optional</td>
<td align="left"><code>0</code></td>
</tr>
<tr>
<td align="left"><a id="user-content-gcs_archive-patches"></a>patches</td>
<td align="left">A list of files that are to be applied as patches after extracting the archive. It uses the Bazel-native patch implementation which doesn't support fuzz match and binary patch.</td>
<td align="left"><a href="https://bazel.build/concepts/labels" rel="nofollow">List of labels</a></td>
<td align="left">optional</td>
<td align="left"><code>[]</code></td>
</tr>
<tr>
<td align="left"><a id="user-content-gcs_archive-rename_files"></a>rename_files</td>
<td align="left">An optional dict specifying files to rename during the extraction. Archive entries with names exactly matching a key will be renamed to the value, prior to any directory prefix adjustment. This can be used to extract archives that contain non-Unicode filenames, or which have files that would extract to the same path on case-insensitive filesystems.</td>
<td align="left"><a href="https://bazel.build/rules/lib/dict" rel="nofollow">Dictionary: String -&gt; String</a></td>
<td align="left">optional</td>
<td align="left"><code>{}</code></td>
</tr>
<tr>
<td align="left"><a id="user-content-gcs_archive-repo_mapping"></a>repo_mapping</td>
<td align="left">In <code>WORKSPACE</code> context only: a dictionary from local repository name to global repository name. This allows controls over workspace dependency resolution for dependencies of this repository.<br><br>For example, an entry <code>"@foo": "@bar"</code> declares that, for any time this repository depends on <code>@foo</code> (such as a dependency on <code>@foo//some:target</code>, it should actually resolve that dependency within globally-declared <code>@bar</code> (<code>@bar//some:target</code>).<br><br>This attribute is <em>not</em> supported in <code>MODULE.bazel</code> context (when invoking a repository rule inside a module extension's implementation function).</td>
<td align="left"><a href="https://bazel.build/rules/lib/dict" rel="nofollow">Dictionary: String -&gt; String</a></td>
<td align="left">optional</td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><a id="user-content-gcs_archive-sha256"></a>sha256</td>
<td align="left">The expected SHA-256 of the file downloaded.<br><br>This must match the SHA-256 of the file downloaded. It is a security risk to omit the SHA-256 as remote files can change. At best omitting this field will make your build non-hermetic. It is optional to make development easier but either this attribute or <code>integrity</code> should be set before shipping.</td>
<td align="left">String</td>
<td align="left">optional</td>
<td align="left"><code>""</code></td>
</tr>
<tr>
<td align="left"><a id="user-content-gcs_archive-strip_prefix"></a>strip_prefix</td>
<td align="left">A directory prefix to strip from the extracted files.<br><br>Many archives contain a top-level directory that contains all of the useful files in archive. Instead of needing to specify this prefix over and over in the <code>build_file</code>, this field can be used to strip it from all of the extracted files.<br><br>For example, suppose you are using <code>foo-lib-latest.zip</code>, which contains the directory <code>foo-lib-1.2.3/</code> under which there is a <code>WORKSPACE</code> file and are <code>src/</code>, <code>lib/</code>, and <code>test/</code> directories that contain the actual code you wish to build. Specify <code>strip_prefix = "foo-lib-1.2.3"</code> to use the <code>foo-lib-1.2.3</code> directory as your top-level directory.<br><br>Note that if there are files outside of this directory, they will be discarded and inaccessible (e.g., a top-level license file). This includes files/directories that start with the prefix but are not in the directory (e.g., <code>foo-lib-1.2.3.release-notes</code>). If the specified prefix does not match a directory in the archive, Bazel will return an error.</td>
<td align="left">String</td>
<td align="left">optional</td>
<td align="left"><code>""</code></td>
</tr>
<tr>
<td align="left"><a id="user-content-gcs_archive-type"></a>type</td>
<td align="left">The archive type of the downloaded file.<br><br>By default, the archive type is determined from the file extension of the URL. If the file has no extension, you can explicitly specify one of the following: <code>"zip"</code>, <code>"jar"</code>, <code>"war"</code>, <code>"aar"</code>, <code>"tar"</code>, <code>"tar.gz"</code>, <code>"tgz"</code>, <code>"tar.xz"</code>, <code>"txz"</code>, <code>"tar.zst"</code>, <code>"tzst"</code>, <code>"tar.bz2"</code>, <code>"ar"</code>, or <code>"deb"</code>.</td>
<td align="left">String</td>
<td align="left">optional</td>
<td align="left"><code>""</code></td>
</tr>
<tr>
<td align="left"><a id="user-content-gcs_archive-url"></a>url</td>
<td align="left">A URL to a file that will be made available to Bazel. This must be a 'gs://' URL.</td>
<td align="left">String</td>
<td align="left">required</td>
<td align="left"></td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<p dir="auto"><a id="user-content-gcs_file"></a></p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">gcs_file</h2><a id="user-content-gcs_file" class="anchor" aria-label="Permalink: gcs_file" href="#gcs_file"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<pre>load("@rules_gcs//gcs:repo_rules.bzl", "gcs_file")

gcs_file(<a href="#gcs_file-name">name</a>, <a href="#gcs_file-canonical_id">canonical_id</a>, <a href="#gcs_file-downloaded_file_path">downloaded_file_path</a>, <a href="#gcs_file-executable">executable</a>, <a href="#gcs_file-integrity">integrity</a>, <a href="#gcs_file-repo_mapping">repo_mapping</a>, <a href="#gcs_file-sha256">sha256</a>, <a href="#gcs_file-url">url</a>)
</pre>
<p dir="auto">Downloads a file from a GCS bucket and makes it available to be used as a file group.</p>
<p dir="auto">Examples:
Suppose you need to have a large file that is read during a test and is stored in a private bucket.
This file is available from gs://my_org_assets/testdata.bin.
Then you can add to your MODULE.bazel file:</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="gcs_file = use_repo_rule(&quot;@rules_gcs//gcs:repo_rules.bzl&quot;, &quot;gcs_file&quot;)

gcs_file(
    name = &quot;my_testdata&quot;,
    url = &quot;gs://my_org_assets/testdata.bin&quot;,
    sha256 = &quot;e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855&quot;,
)"><pre><span class="pl-s1">gcs_file</span> <span class="pl-c1">=</span> <span class="pl-en">use_repo_rule</span>(<span class="pl-s">"@rules_gcs//gcs:repo_rules.bzl"</span>, <span class="pl-s">"gcs_file"</span>)

<span class="pl-en">gcs_file</span>(
    <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"my_testdata"</span>,
    <span class="pl-s1">url</span> <span class="pl-c1">=</span> <span class="pl-s">"gs://my_org_assets/testdata.bin"</span>,
    <span class="pl-s1">sha256</span> <span class="pl-c1">=</span> <span class="pl-s">"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"</span>,
)</pre></div>
<p dir="auto">Targets would specify <code>@my_testdata//file</code> as a dependency to depend on this file.</p>
<p dir="auto"><strong>ATTRIBUTES</strong></p>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th align="left">Name</th>
<th align="left">Description</th>
<th align="left">Type</th>
<th align="left">Mandatory</th>
<th align="left">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><a id="user-content-gcs_file-name"></a>name</td>
<td align="left">A unique name for this repository.</td>
<td align="left"><a href="https://bazel.build/concepts/labels#target-names" rel="nofollow">Name</a></td>
<td align="left">required</td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><a id="user-content-gcs_file-canonical_id"></a>canonical_id</td>
<td align="left">A canonical ID of the file downloaded.<br><br>If specified and non-empty, Bazel will not take the file from cache, unless it was added to the cache by a request with the same canonical ID.<br><br>If unspecified or empty, Bazel by default uses the URLs of the file as the canonical ID. This helps catch the common mistake of updating the URLs without also updating the hash, resulting in builds that succeed locally but fail on machines without the file in the cache.</td>
<td align="left">String</td>
<td align="left">optional</td>
<td align="left"><code>""</code></td>
</tr>
<tr>
<td align="left"><a id="user-content-gcs_file-downloaded_file_path"></a>downloaded_file_path</td>
<td align="left">Optional output path for the downloaded file. The remote path from the URL is used as a fallback.</td>
<td align="left">String</td>
<td align="left">optional</td>
<td align="left"><code>""</code></td>
</tr>
<tr>
<td align="left"><a id="user-content-gcs_file-executable"></a>executable</td>
<td align="left">If the downloaded file should be made executable.</td>
<td align="left">Boolean</td>
<td align="left">optional</td>
<td align="left"><code>False</code></td>
</tr>
<tr>
<td align="left"><a id="user-content-gcs_file-integrity"></a>integrity</td>
<td align="left">Expected checksum in Subresource Integrity format of the file downloaded.<br><br>This must match the checksum of the file downloaded. It is a security risk to omit the checksum as remote files can change. At best omitting this field will make your build non-hermetic. It is optional to make development easier but either this attribute or <code>sha256</code> should be set before shipping.</td>
<td align="left">String</td>
<td align="left">optional</td>
<td align="left"><code>""</code></td>
</tr>
<tr>
<td align="left"><a id="user-content-gcs_file-repo_mapping"></a>repo_mapping</td>
<td align="left">In <code>WORKSPACE</code> context only: a dictionary from local repository name to global repository name. This allows controls over workspace dependency resolution for dependencies of this repository.<br><br>For example, an entry <code>"@foo": "@bar"</code> declares that, for any time this repository depends on <code>@foo</code> (such as a dependency on <code>@foo//some:target</code>, it should actually resolve that dependency within globally-declared <code>@bar</code> (<code>@bar//some:target</code>).<br><br>This attribute is <em>not</em> supported in <code>MODULE.bazel</code> context (when invoking a repository rule inside a module extension's implementation function).</td>
<td align="left"><a href="https://bazel.build/rules/lib/dict" rel="nofollow">Dictionary: String -&gt; String</a></td>
<td align="left">optional</td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><a id="user-content-gcs_file-sha256"></a>sha256</td>
<td align="left">The expected SHA-256 of the file downloaded.<br><br>This must match the SHA-256 of the file downloaded. <em>It is a security risk to omit the SHA-256 as remote files can change.</em> At best omitting this field will make your build non-hermetic. It is optional to make development easier but should be set before shipping.</td>
<td align="left">String</td>
<td align="left">optional</td>
<td align="left"><code>""</code></td>
</tr>
<tr>
<td align="left"><a id="user-content-gcs_file-url"></a>url</td>
<td align="left">A URL to a file that will be made available to Bazel. This must be a 'gs://' URL.</td>
<td align="left">String</td>
<td align="left">required</td>
<td align="left"></td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<p dir="auto"><a id="user-content-gcs_bucket"></a></p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">gcs_bucket</h2><a id="user-content-gcs_bucket" class="anchor" aria-label="Permalink: gcs_bucket" href="#gcs_bucket"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<pre>gcs_bucket = use_extension("@rules_gcs//gcs:extensions.bzl", "gcs_bucket")
gcs_bucket.from_file(<a href="#gcs_bucket.from_file-name">name</a>, <a href="#gcs_bucket.from_file-bucket">bucket</a>, <a href="#gcs_bucket.from_file-dev_dependency">dev_dependency</a>, <a href="#gcs_bucket.from_file-lockfile">lockfile</a>, <a href="#gcs_bucket.from_file-lockfile_jsonpath">lockfile_jsonpath</a>, <a href="#gcs_bucket.from_file-method">method</a>)
</pre>
<p dir="auto">Downloads a collection of objects from a GCS bucket and makes them available under a single hub repository name.</p>
<p dir="auto">Examples:
Suppose your code depends on a collection of large assets that are used during code generation or testing. Those assets are stored in a private gcs bucket <code>gs://my_org_assets</code>.</p>
<p dir="auto">In the local repository, the user creates a <code>gcs_lock.json</code> JSON lockfile describing the required objects, including their expected hashes:</p>
<div class="highlight highlight-source-json notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="  {
      &quot;trainingdata/model/small.bin&quot;: {
          &quot;sha256&quot;: &quot;abd83816bd236b266c3643e6c852b446f068fe260f3296af1a25b550854ec7e5&quot;
      },
      &quot;trainingdata/model/medium.bin&quot;: {
          &quot;sha256&quot;: &quot;c6f9568f930b16101089f1036677bb15a3185e9ed9b8dbce2f518fb5a52b6787&quot;
      },
      &quot;trainingdata/model/large.bin&quot;: {
          &quot;sha256&quot;: &quot;b3ccb0ba6f7972074b0a1e13340307abfd5a5eef540c521a88b368891ec5cd6b&quot;
      },
      &quot;trainingdata/model/very_large.bin&quot;: {
          &quot;remote_path&quot;: &quot;weird/nested/path/extra/model/very_large.bin&quot;,
          &quot;integrity&quot;: &quot;sha256-Oibw8PV3cDY84HKv3sAWIEuk+R2s8Hwhvlg6qg4H7uY=&quot;
      }
  }"><pre>  {
      <span class="pl-ent">"trainingdata/model/small.bin"</span>: {
          <span class="pl-ent">"sha256"</span>: <span class="pl-s"><span class="pl-pds">"</span>abd83816bd236b266c3643e6c852b446f068fe260f3296af1a25b550854ec7e5<span class="pl-pds">"</span></span>
      },
      <span class="pl-ent">"trainingdata/model/medium.bin"</span>: {
          <span class="pl-ent">"sha256"</span>: <span class="pl-s"><span class="pl-pds">"</span>c6f9568f930b16101089f1036677bb15a3185e9ed9b8dbce2f518fb5a52b6787<span class="pl-pds">"</span></span>
      },
      <span class="pl-ent">"trainingdata/model/large.bin"</span>: {
          <span class="pl-ent">"sha256"</span>: <span class="pl-s"><span class="pl-pds">"</span>b3ccb0ba6f7972074b0a1e13340307abfd5a5eef540c521a88b368891ec5cd6b<span class="pl-pds">"</span></span>
      },
      <span class="pl-ent">"trainingdata/model/very_large.bin"</span>: {
          <span class="pl-ent">"remote_path"</span>: <span class="pl-s"><span class="pl-pds">"</span>weird/nested/path/extra/model/very_large.bin<span class="pl-pds">"</span></span>,
          <span class="pl-ent">"integrity"</span>: <span class="pl-s"><span class="pl-pds">"</span>sha256-Oibw8PV3cDY84HKv3sAWIEuk+R2s8Hwhvlg6qg4H7uY=<span class="pl-pds">"</span></span>
      }
  }</pre></div>
<p dir="auto">The exact format for the lockfile is a JSON object where each key is a path to a local file in the repository and the value is a JSON object with the following keys:</p>
<ul dir="auto">
<li><code>sha256</code>: the expected sha256 hash of the file. Required unless <code>integrity</code> is used.</li>
<li><code>integrity</code>: the expected SRI value of the file. Required unless <code>sha256</code> is used.</li>
<li><code>remote_path</code>: name of the object within the bucket. If not set, the local path is used.</li>
</ul>
<p dir="auto">Targets in the main repository can depend on this target if the
following lines are added to <code>MODULE.bazel</code>:</p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="gcs_bucket = use_extension(&quot;@rules_gcs//gcs:extensions.bzl&quot;, &quot;gcs_bucket&quot;)
gcs_bucket.from_file(
    name = &quot;trainingdata&quot;,
    bucket = &quot;my_org_assets&quot;,
    lockfile = &quot;@//:gcs_lock.json&quot;,
)"><pre><span class="pl-s1">gcs_bucket</span> <span class="pl-c1">=</span> <span class="pl-en">use_extension</span>(<span class="pl-s">"@rules_gcs//gcs:extensions.bzl"</span>, <span class="pl-s">"gcs_bucket"</span>)
<span class="pl-s1">gcs_bucket</span>.<span class="pl-c1">from_file</span>(
    <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"trainingdata"</span>,
    <span class="pl-s1">bucket</span> <span class="pl-c1">=</span> <span class="pl-s">"my_org_assets"</span>,
    <span class="pl-s1">lockfile</span> <span class="pl-c1">=</span> <span class="pl-s">"@//:gcs_lock.json"</span>,
)</pre></div>
<p dir="auto">Then targets would specify labels like <code>@trainingdata//:trainingdata/model/very_large.bin</code> as a dependency.</p>
<p dir="auto"><strong>TAG CLASSES</strong></p>
<p dir="auto"><a id="user-content-gcs_bucket.from_file"></a></p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">from_file</h3><a id="user-content-from_file" class="anchor" aria-label="Permalink: from_file" href="#from_file"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><strong>Attributes</strong></p>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th align="left">Name</th>
<th align="left">Description</th>
<th align="left">Type</th>
<th align="left">Mandatory</th>
<th align="left">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><a id="user-content-gcs_bucket.from_file-name"></a>name</td>
<td align="left">Name of the hub repository containing referencing all blobs</td>
<td align="left"><a href="https://bazel.build/concepts/labels#target-names" rel="nofollow">Name</a></td>
<td align="left">required</td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><a id="user-content-gcs_bucket.from_file-bucket"></a>bucket</td>
<td align="left">Name of the GCS bucket</td>
<td align="left">String</td>
<td align="left">required</td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><a id="user-content-gcs_bucket.from_file-dev_dependency"></a>dev_dependency</td>
<td align="left">If true, this dependency will be ignored if the current module is not the root module or <code>--ignore_dev_dependency</code> is enabled.</td>
<td align="left">Boolean</td>
<td align="left">optional</td>
<td align="left"><code>False</code></td>
</tr>
<tr>
<td align="left"><a id="user-content-gcs_bucket.from_file-lockfile"></a>lockfile</td>
<td align="left">JSON lockfile containing objects to load from the GCS bucket</td>
<td align="left"><a href="https://bazel.build/concepts/labels" rel="nofollow">Label</a></td>
<td align="left">required</td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><a id="user-content-gcs_bucket.from_file-lockfile_jsonpath"></a>lockfile_jsonpath</td>
<td align="left">JSONPath expression referencing the dict of paths. By default, the top-level object is used.</td>
<td align="left">String</td>
<td align="left">optional</td>
<td align="left"><code>""</code></td>
</tr>
<tr>
<td align="left"><a id="user-content-gcs_bucket.from_file-method"></a>method</td>
<td align="left">Method used for downloading:<br><br><code>symlink</code>: lazy fetching with symlinks, <code>alias</code>: lazy fetching with alias targets, <code>copy</code>: lazy fetching with full file copies, <code>eager</code>: all objects are fetched eagerly</td>
<td align="left">String</td>
<td align="left">optional</td>
<td align="left"><code>"symlink"</code></td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Troubleshooting</h2><a id="user-content-troubleshooting" class="anchor" aria-label="Permalink: Troubleshooting" href="#troubleshooting"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li>
<p dir="auto">Credential helper not found</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="WARNING: Error retrieving auth headers, continuing without: Failed to get credentials for 'https://storage.googleapis.com/broad-public-datasets/intervals_hg38.list' from helper 'tools/credential-helper': Cannot run program &quot;tools/credential-helper&quot; (in directory &quot;...&quot;): error=2, No such file or directory"><pre class="notranslate"><code>WARNING: Error retrieving auth headers, continuing without: Failed to get credentials for 'https://storage.googleapis.com/broad-public-datasets/intervals_hg38.list' from helper 'tools/credential-helper': Cannot run program "tools/credential-helper" (in directory "..."): error=2, No such file or directory
</code></pre></div>
<p dir="auto">You need to install a credential helper (either <a href="https://github.com/tweag/credential-helper"><code>tweag-credential-helper</code></a>, the <a href="/tools/credential-helper">shell script</a>, or your own) as explained <a href="#installation">above</a>.</p>
</li>
<li>
<p dir="auto">Credential helper not working</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="WARNING: Error retrieving auth headers, continuing without: Failed to get credentials for 'https://storage.googleapis.com/...' from helper 'tools/credential-helper': process timed out"><pre class="notranslate"><code>WARNING: Error retrieving auth headers, continuing without: Failed to get credentials for 'https://storage.googleapis.com/...' from helper 'tools/credential-helper': process timed out
</code></pre></div>
<p dir="auto">Run <code>gcloud auth application-default print-access-token</code> to see why it fails and ensure you are logged in and have application default credentials configured.</p>
</li>
<li>
<p dir="auto">HTTP 401 or 403 error codes</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="ERROR: Target parsing failed due to unexpected exception: java.io.IOException: Error downloading [https://storage.googleapis.com/...] to ...: GET returned 403 Forbidden"><pre class="notranslate"><code>ERROR: Target parsing failed due to unexpected exception: java.io.IOException: Error downloading [https://storage.googleapis.com/...] to ...: GET returned 403 Forbidden
</code></pre></div>
<p dir="auto">Ensure the user you are logged in as has access to the bucket using <code>gsutil ls gs://&lt;BUCKET_NAME&gt;/&lt;OBJECT&gt;</code> and check if the credential helper is configured in <code>.bazelrc</code> like this: <code>--credential_helper=storage.googleapis.com=%workspace%/tools/credential-helper</code>.</p>
</li>
<li>
<p dir="auto">Checksum mismatch (empty file downloaded)</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="Error in wait: com.google.devtools.build.lib.bazel.repository.downloader.UnrecoverableHttpException: Checksum was e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855 but wanted &lt;actual&gt;"><pre class="notranslate"><code>Error in wait: com.google.devtools.build.lib.bazel.repository.downloader.UnrecoverableHttpException: Checksum was e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855 but wanted &lt;actual&gt;
</code></pre></div>
<p dir="auto">Check if you are using <code>--experimental_remote_downloader</code>. If you do, the remote cache may drop your auth header and silently give you empty files instead. One workaround is setting <code>--experimental_remote_downloader_local_fallback</code> in <code>.bazelrc</code>.</p>
</li>
</ul>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Acknowledgements</h2><a id="user-content-acknowledgements" class="anchor" aria-label="Permalink: Acknowledgements" href="#acknowledgements"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><em><code>rules_gcs</code> was initially developed by <a href="https://www.imax.com/en/us/sct" rel="nofollow">IMAX</a> and is maintained by Tweag.</em></p>
<section data-footnotes="" class="footnotes"><h2 id="footnote-label" class="sr-only" dir="auto">Footnotes</h2>
<ol dir="auto">
<li id="user-content-fn-1-bf8a993e765fb7836c6fd8c0156b482c">
<p dir="auto">The <code>gcloud</code> CLI tool is still required to obtain authentication tokens when using the provided shell script as a credential helper. We recommend <a href="https://github.com/tweag/credential-helper"><code>tweag-credential-helper</code></a>, which doesn't depend on <code>gcloud</code>. <a href="#user-content-fnref-1-bf8a993e765fb7836c6fd8c0156b482c" data-footnote-backref="" aria-label="Back to reference 1" class="data-footnote-backref">â†©</a></p>
</li>
</ol>
</section>
</article></div>