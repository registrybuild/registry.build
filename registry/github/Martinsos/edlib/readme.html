<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><div class="markdown-heading" dir="auto"><h1 class="heading-element" dir="auto">Edlib
·
<a href="https://github.com/Martinsos/edlib/releases/latest"><img src="https://camo.githubusercontent.com/c77917fe266d50dbea0d51c9ac1f00f21f6ca3e69eaae71b28e132f2932ba55e/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f72656c656173652f4d617274696e736f732f65646c69622e737667" alt="Latest Github release" data-canonical-src="https://img.shields.io/github/release/Martinsos/edlib.svg" style="max-width: 100%; height: auto;"></a>
<a href="https://github.com/Martinsos/edlib/actions?query=branch%3Amaster"><img src="https://camo.githubusercontent.com/9f83e3487d25a2189c32e4b5c2138103ea176df7930a58621a9fa08758660bb1/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f616374696f6e732f776f726b666c6f772f7374617475732f4d617274696e736f732f65646c69622f63692e79616d6c3f6272616e63683d6d6173746572266c6162656c3d4c696e75782532464f53582532306275696c64" alt="Build status of the master branch on Linux/OSX" data-canonical-src="https://img.shields.io/github/actions/workflow/status/Martinsos/edlib/ci.yaml?branch=master&amp;label=Linux%2FOSX%20build" style="max-width: 100%; height: auto;">
</a>
<a href="https://doi.org/10.1093/bioinformatics/btw753" rel="nofollow"><img src="https://camo.githubusercontent.com/6b27a081b11c5d59dce51bdb457f58e101140cdc74ff923c1ca0f3c3ea58fb5f/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f5075626c6973686564253230696e2d42696f696e666f726d61746963732d3136374441342e737667" alt="Published in Bioinformatics" data-canonical-src="https://img.shields.io/badge/Published%20in-Bioinformatics-167DA4.svg" style="max-width: 100%; height: auto;"></a></h1><a id="user-content-edlib" class="anchor" aria-label="Permalink: Edlib
·
" href="#edlib"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">A lightweight and super fast C/C++ library for sequence alignment using <a href="https://en.wikipedia.org/wiki/Edit_distance" rel="nofollow">edit distance</a>.</p>
<p dir="auto">Calculating edit distance of two strings is as simple as:</p>
<div class="highlight highlight-source-c notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="edlibAlign(&quot;hello&quot;, 5, &quot;world!&quot;, 6, edlibDefaultAlignConfig()).editDistance;"><pre><span class="pl-en">edlibAlign</span>(<span class="pl-s">"hello"</span>, <span class="pl-c1">5</span>, <span class="pl-s">"world!"</span>, <span class="pl-c1">6</span>, <span class="pl-en">edlibDefaultAlignConfig</span>()).<span class="pl-c1">editDistance</span>;</pre></div>
<p dir="auto">Edlib is also available for <strong>Python</strong> <a href="https://pypi.python.org/pypi/edlib" rel="nofollow"><img src="https://camo.githubusercontent.com/3e0b77128e34eb059e5768bc0e9ae83c012973105a41ca18e91cfcecd7844422/68747470733a2f2f696d672e736869656c64732e696f2f707970692f762f65646c69622e737667" alt="PyPI version" data-canonical-src="https://img.shields.io/pypi/v/edlib.svg" style="max-width: 100%; height: auto;"> (Click here for Python README)</a>, with code residing at <a href="bindings/python">bindings/python</a>.</p>
<p dir="auto">There are third-party bindings to edlib in other languages as well:</p>
<ul dir="auto">
<li><a href="https://github.com/cjdoris/Edlib.jl">Edlib.jl</a>, a Julia package created and supported by Christopher Rowley (<a href="https://github.com/cjdoris">@cjdoris</a>)</li>
<li><a href="https://github.com/evanbiederstedt/edlibr">edlibR</a>, an R package created and supported by Evan Biederstedt (<a href="https://github.com/evanbiederstedt">@evanbiederstedt</a>)</li>
<li><a href="https://github.com/kojix2/ruby-edlib">ruby-edlib</a>, a Ruby package created and supported by <a href="https://github.com/kojix2">@kojix2</a></li>
<li><a href="https://metacpan.org/pod/Text::Levenshtein::Edlib" rel="nofollow">Text::Levenshtein::Edlib</a>, a Perl wrapper created and supported by <a href="https://metacpan.org/author/MGV" rel="nofollow">Marius Gavrilescu</a></li>
</ul>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Features</h2><a id="user-content-features" class="anchor" aria-label="Permalink: Features" href="#features"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li>Calculates <strong>edit distance (Levenshtein distance)</strong>.</li>
<li>It can find <strong>optimal alignment path</strong> (instructions how to transform first sequence into the second sequence).</li>
<li>It can find just the <strong>start and/or end locations of alignment path</strong> - can be useful when speed is more important than having exact alignment path.</li>
<li>Supports <strong>multiple <a href="#alignment-methods">alignment methods</a></strong>: global(<strong>NW</strong>), prefix(<strong>SHW</strong>) and infix(<strong>HW</strong>), each of them useful for different scenarios.</li>
<li>You can <strong>extend character equality definition</strong>, enabling you to e.g. have wildcard characters, to have case insensitive alignment or to work with degenerate nucleotides.</li>
<li>It can easily handle small or <strong>very large sequences</strong>, even when finding alignment path, while consuming very little memory.</li>
<li><strong>Super fast</strong> thanks to Myers's bit-vector algorithm.</li>
</ul>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Contents</h2><a id="user-content-contents" class="anchor" aria-label="Permalink: Contents" href="#contents"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li><a href="#features">Features</a></li>
<li><a href="#building">Building</a></li>
<li><a href="#using-edlib-in-your-project">Using Edlib in your project</a></li>
<li><a href="#usage-and-examples">Usage and examples</a></li>
<li><a href="#api-documentation">API documentation</a></li>
<li><a href="#alignment-methods">Alignment methods</a></li>
<li><a href="#aligner">Aligner</a></li>
<li><a href="#running-tests">Running tests</a></li>
<li><a href="#time-and-space-complexity">Time and space complexity</a></li>
<li><a href="#test-data">Test data</a></li>
<li><a href="#development-and-contributing">Development and contributing</a></li>
<li><a href="#publication">Publication</a></li>
<li><a href="#acknowledgements">Acknowledgements</a></li>
</ul>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Using Edlib in your project</h2><a id="user-content-using-edlib-in-your-project" class="anchor" aria-label="Permalink: Using Edlib in your project" href="#using-edlib-in-your-project"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">You can use Edlib in you project by either directly copying header and source files from <a href="edlib/">edlib/</a>, or by linking Edlib library (see <a href="#building">Building</a> for instructions how to build Edlib libraries).
In any case, only thing that you have to do in your source files is to include <code>edlib.h</code>.</p>
<p dir="auto">To get you started quickly, let's take a look at a few ways to get simple Hello World project working.</p>
<p dir="auto">Our Hello World project has just one source file, <code>helloWorld.cpp</code> file, and it looks like this:</p>
<div class="highlight highlight-source-c++ notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="#include &lt;cstdio&gt;
#include &quot;edlib.h&quot;

int main() {
    EdlibAlignResult result = edlibAlign(&quot;hello&quot;, 5, &quot;world!&quot;, 6, edlibDefaultAlignConfig());
    if (result.status == EDLIB_STATUS_OK) {
        printf(&quot;edit_distance('hello', 'world!') = %d\n&quot;, result.editDistance);
    }
    edlibFreeAlignResult(result);
}"><pre>#<span class="pl-k">include</span> <span class="pl-s"><span class="pl-pds">&lt;</span>cstdio<span class="pl-pds">&gt;</span></span>
#<span class="pl-k">include</span> <span class="pl-s"><span class="pl-pds">"</span>edlib.h<span class="pl-pds">"</span></span>

<span class="pl-k">int</span> <span class="pl-en">main</span>() {
    EdlibAlignResult result = <span class="pl-c1">edlibAlign</span>(<span class="pl-s"><span class="pl-pds">"</span>hello<span class="pl-pds">"</span></span>, <span class="pl-c1">5</span>, <span class="pl-s"><span class="pl-pds">"</span>world!<span class="pl-pds">"</span></span>, <span class="pl-c1">6</span>, <span class="pl-c1">edlibDefaultAlignConfig</span>());
    <span class="pl-k">if</span> (result.<span class="pl-smi">status</span> == EDLIB_STATUS_OK) {
        <span class="pl-c1">printf</span>(<span class="pl-s"><span class="pl-pds">"</span>edit_distance('hello', 'world!') = %d<span class="pl-cce">\n</span><span class="pl-pds">"</span></span>, result.<span class="pl-smi">editDistance</span>);
    }
    <span class="pl-c1">edlibFreeAlignResult</span>(result);
}</pre></div>
<p dir="auto">Running it should output <code>edit_distance('hello', 'world!') = 5</code>.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Approach #1: Directly copying edlib source and header files.</h3><a id="user-content-approach-1-directly-copying-edlib-source-and-header-files" class="anchor" aria-label="Permalink: Approach #1: Directly copying edlib source and header files." href="#approach-1-directly-copying-edlib-source-and-header-files"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Here we directly copied <a href="edlib/">edlib/</a> directory to our project, to get following project structure:</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="edlib/  -&gt; copied from edlib/
  include/
    edlib.h
  src/
    edlib.cpp
helloWorld.cpp -&gt; your program"><pre class="notranslate"><code>edlib/  -&gt; copied from edlib/
  include/
    edlib.h
  src/
    edlib.cpp
helloWorld.cpp -&gt; your program
</code></pre></div>
<p dir="auto">Since <code>helloWorld</code> is a c++ program, we can compile it with just one line: <code>c++ helloWorld.cpp edlib/src/edlib.cpp -o helloWorld -I edlib/include</code>.</p>
<p dir="auto">If hello world was a C program, we would compile it like this:</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="    c++ -c edlib/src/edlib.cpp -o edlib.o -I edlib/include
    cc -c helloWorld.c -o helloWorld.o -I edlib/include
    c++ helloWorld.o edlib.o -o helloWorld"><pre class="notranslate"><code>    c++ -c edlib/src/edlib.cpp -o edlib.o -I edlib/include
    cc -c helloWorld.c -o helloWorld.o -I edlib/include
    c++ helloWorld.o edlib.o -o helloWorld
</code></pre></div>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Approach #2: Copying edlib header file and static library.</h3><a id="user-content-approach-2-copying-edlib-header-file-and-static-library" class="anchor" aria-label="Permalink: Approach #2: Copying edlib header file and static library." href="#approach-2-copying-edlib-header-file-and-static-library"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Instead of copying edlib source files, you could copy static library (check <a href="#building">Building</a> on how to create static library). We also need to copy edlib header files. We get following project structure:</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="edlib/  -&gt; copied from edlib
  include/
    edlib.h
  edlib.a
helloWorld.cpp -&gt; your program"><pre class="notranslate"><code>edlib/  -&gt; copied from edlib
  include/
    edlib.h
  edlib.a
helloWorld.cpp -&gt; your program
</code></pre></div>
<p dir="auto">Now you can compile it with <code>c++ helloWorld.cpp -o helloWorld -I edlib/include -L edlib -ledlib</code>.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Approach #3: Install edlib library on machine.</h3><a id="user-content-approach-3-install-edlib-library-on-machine" class="anchor" aria-label="Permalink: Approach #3: Install edlib library on machine." href="#approach-3-install-edlib-library-on-machine"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Alternatively, you could avoid copying any Edlib files and instead install libraries by running <code>sudo make install</code> (check <a href="#building">Building</a> for exact instructions depending on approach you used for building). Now, all you have to do to compile your project is <code>c++ helloWorld.cpp -o helloWorld -ledlib</code>.
If you get error message like <code>cannot open shared object file: No such file or directory</code>, make sure that your linker includes path where edlib was installed.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Approach #4: Use edlib in your project via CMake.</h3><a id="user-content-approach-4-use-edlib-in-your-project-via-cmake" class="anchor" aria-label="Permalink: Approach #4: Use edlib in your project via CMake." href="#approach-4-use-edlib-in-your-project-via-cmake"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">Using git submodule</h4><a id="user-content-using-git-submodule" class="anchor" aria-label="Permalink: Using git submodule" href="#using-git-submodule"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">If you are using CMake for compilation, we suggest adding edlib as a git submodule with the command <code>git submodule add https://github.com/martinsos/edlib vendor/edlib</code>. Afterwards, modify your top level CMakeLists.txt file accordingly:</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="add_subdirectory(vendor/edlib EXCLUDE_FROM_ALL)
target_link_libraries(your_exe edlib) # or target_link_libraries(your_exe edlib)"><pre class="notranslate"><code>add_subdirectory(vendor/edlib EXCLUDE_FROM_ALL)
target_link_libraries(your_exe edlib) # or target_link_libraries(your_exe edlib)
</code></pre></div>
<p dir="auto">The <code>add_subdirectory</code> command adds a folder to the build tree, meaning it will run CMakeLists.txt from the included folder as well. Flag <code>EXCLUDE_FROM_ALL</code> disables building (and instalment) of targets in the added folder which are not needed in your project. In the above example only the (static) library <code>edlib</code> will be build, while <code>edlib-aligner</code>, <code>hello_world</code> and the rest won't. In order to access the <code>edlib</code> API, add <code>#include "edlib.h"</code> in your source file (CMake will automatically update your include path).</p>
<p dir="auto">For more example projects take a look at applications in <a href="apps/">apps/</a>.</p>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">Using VCPKG</h4><a id="user-content-using-vcpkg" class="anchor" aria-label="Permalink: Using VCPKG" href="#using-vcpkg"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Edlib is available on <a href="https://github.com/microsoft/vcpkg">VCPKG</a> package manager. With VCPKG on your system, Edlib can be downloaded using the VCPKG install command <code>vcpkg install edlib</code>. Once the library has been downloaded, add the following instructions to your CMakeLists.txt file:</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="find_package(edlib CONFIG REQUIRED)
target_link_libraries(MyProject PRIVATE edlib::edlib)"><pre class="notranslate"><code>find_package(edlib CONFIG REQUIRED)
target_link_libraries(MyProject PRIVATE edlib::edlib)
</code></pre></div>
<p dir="auto">then you should be able to include the library header in your project (<code>#include "edlib.h</code>)</p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Building</h2><a id="user-content-building" class="anchor" aria-label="Permalink: Building" href="#building"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Meson</h3><a id="user-content-meson" class="anchor" aria-label="Permalink: Meson" href="#meson"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Primary way of building Edlib is via <a href="https://mesonbuild.com/" rel="nofollow">Meson</a> build tool.</p>
<p dir="auto">Requirements: make sure that you have <code>meson</code> installed on your system.</p>
<p dir="auto">Execute</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="make"><pre class="notranslate"><code>make
</code></pre></div>
<p dir="auto">to build <strong>static</strong> library and binaries (apps and tests) and also run tests.<br>
To build <strong>shared</strong> library and binaries, do <code>make LIBRARY_TYPE=shared</code>.</p>
<p dir="auto">Library and binaries will be created in <code>meson-build</code> directory.<br>
You can choose alternate build directory like this: <code>make BUILD_DIR=some-other-dir</code>.</p>
<p dir="auto">Optionally, you can run</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="sudo make install"><pre class="notranslate"><code>sudo make install
</code></pre></div>
<p dir="auto">to install edlib library on your machine (on Linux, this will usually install it to <code>usr/local/lib</code> and <code>usr/local/include</code>).</p>
<p dir="auto">Check Makefile if you want to run individual steps on your own (building, tests, ...).</p>
<p dir="auto">NOTE: If you need more control, use <code>meson</code> command directly, <code>Makefile</code> is here only to help with common commands.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">CMake</h3><a id="user-content-cmake" class="anchor" aria-label="Permalink: CMake" href="#cmake"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Edlib can alternatively be built with CMake.</p>
<p dir="auto">Execute following command to build Edlib using CMAKE:</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="cd build &amp;&amp; cmake -D CMAKE_BUILD_TYPE=Release .. &amp;&amp; make"><pre class="notranslate"><code>cd build &amp;&amp; cmake -D CMAKE_BUILD_TYPE=Release .. &amp;&amp; make
</code></pre></div>
<p dir="auto">This will create binaries in <code>bin/</code> directory and libraries (static and shared) in <code>lib/</code> directory.</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="./bin/runTests"><pre class="notranslate"><code>./bin/runTests
</code></pre></div>
<p dir="auto">to run tests.</p>
<p dir="auto">Optionally, you can run</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="sudo make install"><pre class="notranslate"><code>sudo make install
</code></pre></div>
<p dir="auto">to install edlib library on your machine.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Conda</h3><a id="user-content-conda" class="anchor" aria-label="Permalink: Conda" href="#conda"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Edlib can also be installed via Conda: <a href="https://conda.anaconda.org/bioconda" rel="nofollow"><img src="https://camo.githubusercontent.com/35fc07945bacb50a95b84ea40de08000cb7fe073c8e085073919ea8e1e53c800/68747470733a2f2f616e61636f6e64612e6f72672f62696f636f6e64612f65646c69622f6261646765732f696e7374616c6c65722f636f6e64612e737667" alt="Anaconda-Server Badge" data-canonical-src="https://anaconda.org/bioconda/edlib/badges/installer/conda.svg" style="max-width: 100%; height: auto;"></a>: <code>conda install edlib</code>.</p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Usage and examples</h2><a id="user-content-usage-and-examples" class="anchor" aria-label="Permalink: Usage and examples" href="#usage-and-examples"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Main function in edlib is <code>edlibAlign</code>. Given two sequences (and their lengths), it will find edit distance, alignment path or its end and start locations.</p>
<div class="highlight highlight-source-c notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="char* query = &quot;ACCTCTG&quot;;
char* target = &quot;ACTCTGAAA&quot;
EdlibAlignResult result = edlibAlign(query, 7, target, 9, edlibDefaultAlignConfig());
if (result.status == EDLIB_STATUS_OK) {
    printf(&quot;%d&quot;, result.editDistance);
}
edlibFreeAlignResult(result);"><pre><span class="pl-smi">char</span><span class="pl-c1">*</span> <span class="pl-s1">query</span> <span class="pl-c1">=</span> <span class="pl-s">"ACCTCTG"</span>;
<span class="pl-smi">char</span><span class="pl-c1">*</span> <span class="pl-s1">target</span> <span class="pl-c1">=</span> <span class="pl-s">"ACTCTGAAA"</span>
<span class="pl-s1">EdlibAlignResult</span> <span class="pl-s1">result</span> <span class="pl-c1">=</span> <span class="pl-en">edlibAlign</span>(<span class="pl-s1">query</span>, <span class="pl-c1">7</span>, <span class="pl-s1">target</span>, <span class="pl-c1">9</span>, <span class="pl-en">edlibDefaultAlignConfig</span>());
<span class="pl-k">if</span> (<span class="pl-s1">result</span>.<span class="pl-c1">status</span> <span class="pl-c1">==</span> <span class="pl-c1">EDLIB_STATUS_OK</span>) {
    <span class="pl-en">printf</span>(<span class="pl-s">"%d"</span>, <span class="pl-s1">result</span>.<span class="pl-c1">editDistance</span>);
}
<span class="pl-en">edlibFreeAlignResult</span>(<span class="pl-s1">result</span>);</pre></div>
<p dir="auto">NOTE: One character is expected to occupy one char/byte, meaning that characters spanning multiple chars/bytes are not supported. As long as your alphabet size is &lt;= 256 you can manually map it to numbers/chars from 0 to 255 and solve this that way, but if its size is &gt; 256 then you will not be able to use Edlib.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Configuring edlibAlign()</h3><a id="user-content-configuring-edlibalign" class="anchor" aria-label="Permalink: Configuring edlibAlign()" href="#configuring-edlibalign"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><code>edlibAlign</code> takes configuration object (it is a struct <code>EdlibAlignConfig</code>), which allows you to further customize how alignment will be done. You can choose <a href="#alignment-methods">alignment method</a>, tell edlib what to calculate (just edit distance or also path and locations) and set upper limit for edit distance.</p>
<p dir="auto">For example, if you want to use infix(HW) alignment method, want to find alignment path (and edit distance), are interested in result only if edit distance is not larger than 42 and do not want to extend character equality definition, you would call it like this:</p>
<div class="highlight highlight-source-c notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="edlibAlign(seq1, seq1Length, seq2, seq2Length,
           edlibNewAlignConfig(42, EDLIB_MODE_HW, EDLIB_TASK_PATH, NULL, 0));"><pre><span class="pl-en">edlibAlign</span>(<span class="pl-s1">seq1</span>, <span class="pl-s1">seq1Length</span>, <span class="pl-s1">seq2</span>, <span class="pl-s1">seq2Length</span>,
           <span class="pl-en">edlibNewAlignConfig</span>(<span class="pl-c1">42</span>, <span class="pl-c1">EDLIB_MODE_HW</span>, <span class="pl-c1">EDLIB_TASK_PATH</span>, <span class="pl-c1">NULL</span>, <span class="pl-c1">0</span>));</pre></div>
<p dir="auto">Or, if you want to use suffix(SHW) alignment method, want to find only edit distance, do not have any limits on edit distance and want character '?' to match both itself and characters 'X' and 'Y', you would call it like this:</p>
<div class="highlight highlight-source-c notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="EdlibEqualityPair additionalEqualities[2] = {{'?', 'X'}, {'?', 'Y'}};
edlibAlign(seq1, seq1Length, seq2, seq2Length,
           edlibNewAlignConfig(-1, EDLIB_MODE_SHW, EDLIB_TASK_DISTANCE, additionalEqualities, 2));"><pre><span class="pl-smi">EdlibEqualityPair</span> <span class="pl-s1">additionalEqualities</span>[<span class="pl-c1">2</span>] <span class="pl-c1">=</span> {{<span class="pl-c1">'?'</span>, <span class="pl-c1">'X'</span>}, {<span class="pl-c1">'?'</span>, <span class="pl-c1">'Y'</span>}};
<span class="pl-en">edlibAlign</span>(<span class="pl-s1">seq1</span>, <span class="pl-s1">seq1Length</span>, <span class="pl-s1">seq2</span>, <span class="pl-s1">seq2Length</span>,
           <span class="pl-en">edlibNewAlignConfig</span>(<span class="pl-c1">-1</span>, <span class="pl-c1">EDLIB_MODE_SHW</span>, <span class="pl-c1">EDLIB_TASK_DISTANCE</span>, <span class="pl-s1">additionalEqualities</span>, <span class="pl-c1">2</span>));</pre></div>
<p dir="auto">We used <code>edlibNewAlignConfig</code> helper function to easily create config, however we could have also just created an instance of it and set its members accordingly.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Handling result of edlibAlign()</h3><a id="user-content-handling-result-of-edlibalign" class="anchor" aria-label="Permalink: Handling result of edlibAlign()" href="#handling-result-of-edlibalign"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><code>edlibAlign</code> function returns a result object (<code>EdlibAlignResult</code>), which will contain results of alignment (corresponding to the task that you passed in config).</p>
<div class="highlight highlight-source-c notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="EdlibAlignResult result = edlibAlign(seq1, seq1Length, seq2, seq2Length,
                                     edlibNewAlignConfig(-1, EDLIB_MODE_HW, EDLIB_TASK_PATH, NULL, 0));
if (result.status == EDLIB_STATUS_OK) {
    printf(&quot;%d\n&quot;, result.editDistance);
    printf(&quot;%d\n&quot;, result.alignmentLength);
    printf(&quot;%d\n&quot;, result.endLocations[0]);
}
edlibFreeAlignResult(result);"><pre><span class="pl-smi">EdlibAlignResult</span> <span class="pl-s1">result</span> <span class="pl-c1">=</span> <span class="pl-en">edlibAlign</span>(<span class="pl-s1">seq1</span>, <span class="pl-s1">seq1Length</span>, <span class="pl-s1">seq2</span>, <span class="pl-s1">seq2Length</span>,
                                     <span class="pl-en">edlibNewAlignConfig</span>(<span class="pl-c1">-1</span>, <span class="pl-c1">EDLIB_MODE_HW</span>, <span class="pl-c1">EDLIB_TASK_PATH</span>, <span class="pl-c1">NULL</span>, <span class="pl-c1">0</span>));
<span class="pl-k">if</span> (<span class="pl-s1">result</span>.<span class="pl-c1">status</span> <span class="pl-c1">==</span> <span class="pl-c1">EDLIB_STATUS_OK</span>) {
    <span class="pl-en">printf</span>(<span class="pl-s">"%d\n"</span>, <span class="pl-s1">result</span>.<span class="pl-c1">editDistance</span>);
    <span class="pl-en">printf</span>(<span class="pl-s">"%d\n"</span>, <span class="pl-s1">result</span>.<span class="pl-c1">alignmentLength</span>);
    <span class="pl-en">printf</span>(<span class="pl-s">"%d\n"</span>, <span class="pl-s1">result</span>.<span class="pl-c1">endLocations</span>[<span class="pl-c1">0</span>]);
}
<span class="pl-en">edlibFreeAlignResult</span>(<span class="pl-s1">result</span>);</pre></div>
<p dir="auto">It is important to remember to free the result object using <code>edlibFreeAlignResult</code> function, since Edlib allocates memory on heap for certain members. If you decide to do the cleaning manually and not use <code>edlibFreeAlignResult</code>, do not forget to manually <code>free()</code> required members.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Turning alignment to cigar</h3><a id="user-content-turning-alignment-to-cigar" class="anchor" aria-label="Permalink: Turning alignment to cigar" href="#turning-alignment-to-cigar"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Cigar is a standard way to represent alignment path.
Edlib has helper function that transforms alignment path into cigar.</p>
<div class="highlight highlight-source-c notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="char* cigar = edlibAlignmentToCigar(result.alignment, result.alignmentLength, EDLIB_CIGAR_STANDARD);
printf(&quot;%s&quot;, cigar);
free(cigar);"><pre><span class="pl-smi">char</span><span class="pl-c1">*</span> <span class="pl-s1">cigar</span> <span class="pl-c1">=</span> <span class="pl-en">edlibAlignmentToCigar</span>(<span class="pl-s1">result</span>.<span class="pl-c1">alignment</span>, <span class="pl-s1">result</span>.<span class="pl-c1">alignmentLength</span>, <span class="pl-c1">EDLIB_CIGAR_STANDARD</span>);
<span class="pl-en">printf</span>(<span class="pl-s">"%s"</span>, <span class="pl-s1">cigar</span>);
<span class="pl-en">free</span>(<span class="pl-s1">cigar</span>);</pre></div>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">API documentation</h2><a id="user-content-api-documentation" class="anchor" aria-label="Permalink: API documentation" href="#api-documentation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">For complete documentation of Edlib library API, visit <a href="https://martinsos.github.io/edlib" rel="nofollow">http://martinsos.github.io/edlib</a> (should be updated to the latest release).</p>
<p dir="auto">To generate the latest API documentation yourself from the source, you need to have <a href="www.doxygen.org">doxygen</a> installed.
Position yourself in the root directory and run <code>doxygen</code>, this will generate <code>docs/</code> directory. Then open <code>docs/html/index.html</code> file with you favorite browser.</p>
<p dir="auto">Alternatively, you can directly check <a href="edlib/include/edlib.h">edlib.h</a>.</p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Alignment methods</h2><a id="user-content-alignment-methods" class="anchor" aria-label="Permalink: Alignment methods" href="#alignment-methods"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Edlib supports 3 alignment methods:</p>
<ul dir="auto">
<li><strong>global (NW)</strong> - This is the standard method, when we say "edit distance" this is the method that is assumed.
It tells us the smallest number of operations needed to transform first sequence into second sequence.
<em>This method is appropriate when you want to find out how similar is first sequence to second sequence.</em></li>
<li><strong>prefix (SHW)</strong> - Similar to global method, but with a small twist - gap at query end is not penalized. What that means is that deleting elements from the end of second sequence is "free"!
For example, if we had <code>AACT</code> and <code>AACTGGC</code>, edit distance would be 0, because removing <code>GGC</code> from the end of second sequence is "free" and does not count into total edit distance.
<em>This method is appropriate when you want to find out how well first sequence fits at the beginning of second sequence.</em></li>
<li><strong>infix (HW)</strong>: Similar as prefix method, but with one more twist - gaps at query end <strong>and start</strong> are not penalized. What that means is that deleting elements from the start and end of second sequence is "free"!
For example, if we had <code>ACT</code> and <code>CGACTGAC</code>, edit distance would be 0, because removing <code>CG</code> from the start and <code>GAC</code> from the end of second sequence is "free" and does not count into total edit distance.
<em>This method is appropriate when you want to find out how well first sequence fits at any part of second sequence.</em> For example, if your second sequence was a long text and your first sequence was a sentence from that text, but slightly scrambled, you could use this method to discover how scrambled it is and where it fits in that text.
<em>In bioinformatics, this method is appropriate for aligning read to a sequence.</em></li>
</ul>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Aligner</h2><a id="user-content-aligner" class="anchor" aria-label="Permalink: Aligner" href="#aligner"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Edlib comes with a standalone aligner cli app, which can be found at <a href="apps/aligner">apps/aligner/</a>.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="images/edlib-aligner-screenshot.png"><img src="images/edlib-aligner-screenshot.png" alt="Edlib aligner screenshot" style="max-width: 100%; height: auto;"></a></p>
<p dir="auto">Aligner reads sequences from fasta files, and it can display alignment path in graphical manner or as a cigar.
It also measures calculation time, so it can be useful for testing speed and comparing Edlib with other tools.</p>
<p dir="auto">Check <a href="#building">Building</a> to see how to build binaries (including <code>edlib-aligner</code>).
Run <code>./build/bin/edlib-aligner</code> with no params for help and detailed instructions.</p>
<p dir="auto">Example of usage:
<code>./build/bin/edlib-aligner -p apps/aligner/test_data/query.fasta apps/aligner/test_data/target.fasta</code></p>
<p dir="auto"><strong>NOTE</strong>: Aligner currently does not work on Windows, because it uses <code>getopt</code> to parse command line arguments, which is not supported on Windows.</p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Running tests</h2><a id="user-content-running-tests" class="anchor" aria-label="Permalink: Running tests" href="#running-tests"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Check <a href="#building">Building</a> to see how to build binaries (including binary <code>runTests</code>).
To run tests, just run <code>./runTests</code>. This will run random tests for each alignment method, and also some specific unit tests.</p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Time and space complexity</h2><a id="user-content-time-and-space-complexity" class="anchor" aria-label="Permalink: Time and space complexity" href="#time-and-space-complexity"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Edlib is based on <a href="http://www.gersteinlab.org/courses/452/09-spring/pdf/Myers.pdf" rel="nofollow">Myers's bit-vector algorithm</a> and extends from it.
It calculates a dynamic programming matrix of dimensions <code>Q x T</code>, where <code>Q</code> is the length of the first sequence (query), and <code>T</code> is the length of the second sequence (target). It uses Ukkonen's banded algorithm to reduce the space of search, and there is also parallelization from Myers's algorithm, however time complexity is still quadratic.
Edlib uses Hirschberg's algorithm to find alignment path, therefore space complexity is linear.</p>
<p dir="auto">Time complexity: <code>O(T * Q)</code>.</p>
<p dir="auto">Space complexity: <code>O(T + Q)</code>.</p>
<p dir="auto">It is worth noting that Edlib works best for large, similar sequences, since such sequences get the highest speedup from banded approach and bit-vector parallelization.</p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Test data</h2><a id="user-content-test-data" class="anchor" aria-label="Permalink: Test data" href="#test-data"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">In <a href="test_data">test_data/</a> directory there are different genome sequences, ranging from 10 kbp to 5 Mbp in length. They are ranging in length and similarity, so they can be useful for testing and measuring speed in different scenarios.</p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Development and contributing</h2><a id="user-content-development-and-contributing" class="anchor" aria-label="Permalink: Development and contributing" href="#development-and-contributing"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Feel free to send pull requests and raise issues.</p>
<p dir="auto">When developing, you may want to use <code>-D CMAKE_BUILD_TYPE=Debug</code> flag when calling <code>cmake</code> in order to get debugging flags passed to compiler. This should also happen if you just run <code>cmake ..</code> with no flags, but I think I have noticed it does not always works as expected (probably has something to do with cmake cache). To check which flags is compiler using, run <code>make</code> with <code>VERBOSE=1</code>: <code>make VERBOSE=1</code>.</p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Publication</h2><a id="user-content-publication" class="anchor" aria-label="Permalink: Publication" href="#publication"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Martin Šošić, Mile Šikić; Edlib: a C/C ++ library for fast, exact sequence alignment using edit distance. Bioinformatics 2017 btw753. doi: <a href="https://doi.org/10.1093/bioinformatics/btw753" rel="nofollow">10.1093/bioinformatics/btw753</a></p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Acknowledgements</h2><a id="user-content-acknowledgements" class="anchor" aria-label="Permalink: Acknowledgements" href="#acknowledgements"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Mile Šikić (@msikic) - Mentoring and guidance through whole project.</p>
<p dir="auto">Ivan Sović (@isovic) - Help with testing and prioritizing features, valuable comments on the manuscript.</p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">FAQ</h2><a id="user-content-faq" class="anchor" aria-label="Permalink: FAQ" href="#faq"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">What do terms NW, HW and SHW stand for?</h3><a id="user-content-what-do-terms-nw-hw-and-shw-stand-for" class="anchor" aria-label="Permalink: What do terms NW, HW and SHW stand for?" href="#what-do-terms-nw-hw-and-shw-stand-for"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">NW stands for Needleman-Wunsch, HW for Hybrid Wunsch, and SHW for Semi Hybrid Wunsch. While NW is a common abbreviation, HW and SHW abbreviations were made up at the very start of this project to describe additional modes of alignment. Later we started using terms "global", "infix" and "prefix" more, as they describe the modes better, but terms NW, HW and SHW are still very present in the project.</p>
</article></div>