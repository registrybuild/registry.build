<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><div class="markdown-heading" dir="auto"><h1 class="heading-element" dir="auto">libprotobuf-mutator</h1><a id="user-content-libprotobuf-mutator" class="anchor" aria-label="Permalink: libprotobuf-mutator" href="#libprotobuf-mutator"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><a href="https://github.com/google/libprotobuf-mutator/actions/workflows/cmake-multi-platform.yml?query=event%3Apush"><img src="https://github.com/google/libprotobuf-mutator/actions/workflows/cmake-multi-platform.yml/badge.svg?event=push" alt="Build Status" style="max-width: 100%;"></a>
<a href="https://oss-fuzz-build-logs.storage.googleapis.com/index.html#libprotobuf-mutator" rel="nofollow"><img src="https://camo.githubusercontent.com/30db26bb5e80d84befa540e6ba4269ded2d6e9e1f99f7e05c0e039a7b77db602/68747470733a2f2f6f73732d66757a7a2d6275696c642d6c6f67732e73746f726167652e676f6f676c65617069732e636f6d2f6261646765732f6c696270726f746f6275662d6d757461746f722e737667" alt="Fuzzing Status" data-canonical-src="https://oss-fuzz-build-logs.storage.googleapis.com/badges/libprotobuf-mutator.svg" style="max-width: 100%;"></a></p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Overview</h2><a id="user-content-overview" class="anchor" aria-label="Permalink: Overview" href="#overview"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">libprotobuf-mutator is a library to randomly mutate
<a href="https://github.com/google/protobuf">protobuffers</a>. <br>
It could be used together with guided fuzzing engines, such as <a href="http://libfuzzer.info" rel="nofollow">libFuzzer</a>.</p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Quick start on Debian/Ubuntu</h2><a id="user-content-quick-start-on-debianubuntu" class="anchor" aria-label="Permalink: Quick start on Debian/Ubuntu" href="#quick-start-on-debianubuntu"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Install prerequisites:</p>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="sudo apt-get update
sudo apt-get install protobuf-compiler libprotobuf-dev binutils cmake \
  ninja-build liblzma-dev libz-dev pkg-config autoconf libtool"><pre>sudo apt-get update
sudo apt-get install protobuf-compiler libprotobuf-dev binutils cmake \
  ninja-build liblzma-dev libz-dev pkg-config autoconf libtool</pre></div>
<p dir="auto">Compile and test everything:</p>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="mkdir build
cd build
cmake .. -GNinja -DCMAKE_C_COMPILER=clang -DCMAKE_CXX_COMPILER=clang++ -DCMAKE_BUILD_TYPE=Debug
ninja check"><pre>mkdir build
<span class="pl-c1">cd</span> build
cmake .. -GNinja -DCMAKE_C_COMPILER=clang -DCMAKE_CXX_COMPILER=clang++ -DCMAKE_BUILD_TYPE=Debug
ninja check</pre></div>
<p dir="auto">Clang is only needed for libFuzzer integration. <br>
By default, the system-installed version of
<a href="https://github.com/google/protobuf">protobuf</a> is used.  However, on some
systems, the system version is too old.  You can pass
<code>LIB_PROTO_MUTATOR_DOWNLOAD_PROTOBUF=ON</code> to cmake to automatically download and
build a working version of protobuf.</p>
<p dir="auto">Installation:</p>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="ninja
sudo ninja install"><pre>ninja
sudo ninja install</pre></div>
<p dir="auto">This installs the headers, pkg-config, and static library.
By default the headers are put in <code>/usr/local/include/libprotobuf-mutator</code>.</p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Usage</h2><a id="user-content-usage" class="anchor" aria-label="Permalink: Usage" href="#usage"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">To use libprotobuf-mutator simply include
<a href="/src/mutator.h">mutator.h</a> and
<a href="/src/mutator.cc">mutator.cc</a> into your build files.</p>
<p dir="auto">The <code>ProtobufMutator</code> class implements mutations of the protobuf
tree structure and mutations of individual fields.
The field mutation logic is very basic --
for better results you should override the <code>ProtobufMutator::Mutate*</code>
methods with more sophisticated logic, e.g.
using <a href="http://libfuzzer.info" rel="nofollow">libFuzzer</a>'s mutators.</p>
<p dir="auto">To apply one mutation to a protobuf object do the following:</p>
<div class="highlight highlight-source-c++ notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="class MyProtobufMutator : public protobuf_mutator::Mutator {
 public:
  // Optionally redefine the Mutate* methods to perform more sophisticated mutations.
}
void Mutate(MyMessage* message) {
  MyProtobufMutator mutator;
  mutator.Seed(my_random_seed);
  mutator.Mutate(message, 200);
}"><pre><span class="pl-k">class</span> <span class="pl-en">MyProtobufMutator</span> : <span class="pl-k">public</span> <span class="pl-en">protobuf_mutator</span>::Mutator {
 <span class="pl-k">public:</span>
  <span class="pl-c"><span class="pl-c">//</span> Optionally redefine the Mutate* methods to perform more sophisticated mutations.</span>
}<span class="pl-ii"></span>
<span class="pl-k">void</span> <span class="pl-en">Mutate</span>(MyMessage* message) {
  MyProtobufMutator mutator;
  mutator.<span class="pl-c1">Seed</span>(my_random_seed);
  mutator.<span class="pl-c1">Mutate</span>(message, <span class="pl-c1">200</span>);
}</pre></div>
<p dir="auto">See also the <code>ProtobufMutatorMessagesTest.UsageExample</code> test from
<a href="/src/mutator_test.cc">mutator_test.cc</a>.</p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Integrating with libFuzzer</h2><a id="user-content-integrating-with-libfuzzer" class="anchor" aria-label="Permalink: Integrating with libFuzzer" href="#integrating-with-libfuzzer"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">LibFuzzerProtobufMutator can help to integrate with libFuzzer. For example</p>
<div class="highlight highlight-source-c++ notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="#include &quot;src/libfuzzer/libfuzzer_macro.h&quot;

DEFINE_PROTO_FUZZER(const MyMessageType&amp; input) {
  // Code which needs to be fuzzed.
  ConsumeMyMessageType(input);
}"><pre>#<span class="pl-k">include</span> <span class="pl-s"><span class="pl-pds">"</span>src/libfuzzer/libfuzzer_macro.h<span class="pl-pds">"</span></span>

<span class="pl-en">DEFINE_PROTO_FUZZER</span>(<span class="pl-k">const</span> MyMessageType&amp; input) {
  <span class="pl-c"><span class="pl-c">//</span> Code which needs to be fuzzed.</span>
  <span class="pl-c1">ConsumeMyMessageType</span>(input);
}</pre></div>
<p dir="auto">Please see <a href="/examples/libfuzzer/libfuzzer_example.cc">libfuzzer_example.cc</a> as an example.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Mutation post-processing (experimental)</h3><a id="user-content-mutation-post-processing-experimental" class="anchor" aria-label="Permalink: Mutation post-processing (experimental)" href="#mutation-post-processing-experimental"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Sometimes it's necessary to keep particular values in some fields without which the proto
is going to be rejected by fuzzed code. E.g. code may expect consistency between some fields
or it may use some fields as checksums. Such constraints are going to be significant bottleneck
for fuzzer even if it's capable of inserting acceptable values with time.</p>
<p dir="auto">PostProcessorRegistration can be used to avoid such issue and guide your fuzzer towards interesting
code. It registers callback which will be called for each message of particular type after each mutation.</p>
<div class="highlight highlight-source-c++ notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="static protobuf_mutator::libfuzzer::PostProcessorRegistration&lt;MyMessageType&gt; reg = {
    [](MyMessageType* message, unsigned int seed) {
      TweakMyMessage(message, seed);
    }};

DEFINE_PROTO_FUZZER(const MyMessageType&amp; input) {
  // Code which needs to be fuzzed.
  ConsumeMyMessageType(input);
}"><pre><span class="pl-k">static</span> protobuf_mutator::libfuzzer::PostProcessorRegistration&lt;MyMessageType&gt; reg = {
    [](MyMessageType* message, <span class="pl-k">unsigned</span> <span class="pl-k">int</span> seed) {
      <span class="pl-c1">TweakMyMessage</span>(message, seed);
    }};

<span class="pl-en">DEFINE_PROTO_FUZZER</span>(<span class="pl-k">const</span> MyMessageType&amp; input) {
  <span class="pl-c"><span class="pl-c">//</span> Code which needs to be fuzzed.</span>
  <span class="pl-c1">ConsumeMyMessageType</span>(input);
}</pre></div>
<p dir="auto">Optional: Use seed if callback uses random numbers. It may help later with debugging.</p>
<p dir="auto">Important: Callbacks should be deterministic and avoid modifying good messages.
Callbacks are called for both: mutator generated and user provided inputs, like
corpus or bug reproducer. So if callback performs unnecessary transformation it
may corrupt the reproducer so it stops triggering the bug.</p>
<p dir="auto">Note: You can add callback for any nested message and you can add multiple callbacks for
the same message type.</p>
<div class="highlight highlight-source-c++ notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="static PostProcessorRegistration&lt;MyMessageType&gt; reg1 = {
    [](MyMessageType* message, unsigned int seed) {
      TweakMyMessage(message, seed);
    }};
static PostProcessorRegistration&lt;MyMessageType&gt; reg2 = {
    [](MyMessageType* message, unsigned int seed) {
      DifferentTweakMyMessage(message, seed);
    }};
static PostProcessorRegistration&lt;MyMessageType::Nested&gt; reg_nested = {
    [](MyMessageType::Nested* message, unsigned int seed) {
      TweakMyNestedMessage(message, seed);
    }};

DEFINE_PROTO_FUZZER(const MyMessageType&amp; input) {
  // Code which needs to be fuzzed.
  ConsumeMyMessageType(input);
}"><pre><span class="pl-k">static</span> PostProcessorRegistration&lt;MyMessageType&gt; reg1 = {
    [](MyMessageType* message, <span class="pl-k">unsigned</span> <span class="pl-k">int</span> seed) {
      <span class="pl-c1">TweakMyMessage</span>(message, seed);
    }};
<span class="pl-k">static</span> PostProcessorRegistration&lt;MyMessageType&gt; reg2 = {
    [](MyMessageType* message, <span class="pl-k">unsigned</span> <span class="pl-k">int</span> seed) {
      <span class="pl-c1">DifferentTweakMyMessage</span>(message, seed);
    }};
<span class="pl-k">static</span> PostProcessorRegistration&lt;MyMessageType::Nested&gt; reg_nested = {
    [](MyMessageType::Nested* message, <span class="pl-k">unsigned</span> <span class="pl-k">int</span> seed) {
      <span class="pl-c1">TweakMyNestedMessage</span>(message, seed);
    }};

<span class="pl-en">DEFINE_PROTO_FUZZER</span>(<span class="pl-k">const</span> MyMessageType&amp; input) {
  <span class="pl-c"><span class="pl-c">//</span> Code which needs to be fuzzed.</span>
  <span class="pl-c1">ConsumeMyMessageType</span>(input);
}</pre></div>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">UTF-8 strings</h2><a id="user-content-utf-8-strings" class="anchor" aria-label="Permalink: UTF-8 strings" href="#utf-8-strings"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">"proto2" and "proto3" handle invalid UTF-8 strings differently. In both cases
string should be UTF-8, however only "proto3" enforces that. So if fuzzer is
applied to "proto2" type libprotobuf-mutator will generate any strings including
invalid UTF-8. If it's a "proto3" message type, only valid UTF-8 will be used.</p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Extensions</h2><a id="user-content-extensions" class="anchor" aria-label="Permalink: Extensions" href="#extensions"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Currently the library does not mutate
<a href="https://developers.google.com/protocol-buffers/docs/proto#extensions" rel="nofollow">extensions</a>.
This can be a problem if extension contains required fields so the library will not
be able to change the message into valid initialized state.
You can use <a href="#mutation-post-processing-experimental">post processing hooks</a> to
cleanup/initialize the message as workaround.</p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Users of the library</h2><a id="user-content-users-of-the-library" class="anchor" aria-label="Permalink: Users of the library" href="#users-of-the-library"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li><a href="https://cs.chromium.org/search/?q=DEFINE_.*._PROTO_FUZZER%5C(" rel="nofollow">Chromium</a></li>
<li><a href="https://github.com/envoyproxy/envoy/search?q=DEFINE_TEXT_PROTO_FUZZER+OR+DEFINE_PROTO_FUZZER+OR+DEFINE_BINARY_PROTO_FUZZER&amp;unscoped_q=DEFINE_TEXT_PROTO_FUZZER+OR+DEFINE_PROTO_FUZZER+OR+DEFINE_BINARY_PROTO_FUZZER&amp;type=Code">Envoy</a></li>
<li><a href="https://github.com/llvm-mirror/clang/search?q=DEFINE_TEXT_PROTO_FUZZER+OR+DEFINE_PROTO_FUZZER+OR+DEFINE_BINARY_PROTO_FUZZER&amp;unscoped_q=DEFINE_TEXT_PROTO_FUZZER+OR+DEFINE_PROTO_FUZZER+OR+DEFINE_BINARY_PROTO_FUZZER&amp;type=Code">LLVM</a></li>
</ul>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Grammars</h2><a id="user-content-grammars" class="anchor" aria-label="Permalink: Grammars" href="#grammars"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li>GIF, <a href="https://github.com/google/oss-fuzz/tree/master/projects/giflib">https://github.com/google/oss-fuzz/tree/master/projects/giflib</a></li>
<li>JSON
<ul dir="auto">
<li><a href="https://github.com/google/oss-fuzz/tree/master/projects/jsoncpp">https://github.com/google/oss-fuzz/tree/master/projects/jsoncpp</a></li>
<li><a href="https://github.com/officialcjunior/fuzzrtos/tree/c72e6670e566672ccf8023265cbfad616e75790d/protobufv2">https://github.com/officialcjunior/fuzzrtos/tree/c72e6670e566672ccf8023265cbfad616e75790d/protobufv2</a></li>
</ul>
</li>
<li>Lua 5.1 Language,
<ul dir="auto">
<li><a href="https://github.com/ligurio/lua-c-api-tests/tree/master/tests/luaL_loadbuffer_proto">https://github.com/ligurio/lua-c-api-tests/tree/master/tests/luaL_loadbuffer_proto</a></li>
<li><a href="https://github.com/Spoookyyy/luaj/tree/main/fuzz">https://github.com/Spoookyyy/luaj/tree/main/fuzz</a></li>
</ul>
</li>
<li>PNG, <a href="https://github.com/google/oss-fuzz/tree/master/projects/libpng-proto">https://github.com/google/oss-fuzz/tree/master/projects/libpng-proto</a></li>
<li>SQL
<ul dir="auto">
<li><a href="https://github.com/tarantool/tarantool/tree/master/test/fuzz/sql_fuzzer">https://github.com/tarantool/tarantool/tree/master/test/fuzz/sql_fuzzer</a></li>
<li><a href="https://chromium.googlesource.com/chromium/src/third_party/+/refs/heads/main/sqlite/fuzz" rel="nofollow">https://chromium.googlesource.com/chromium/src/third_party/+/refs/heads/main/sqlite/fuzz</a></li>
</ul>
</li>
<li>Solidity Language, <a href="https://github.com/ethereum/solidity/tree/develop/test/tools/ossfuzz">https://github.com/ethereum/solidity/tree/develop/test/tools/ossfuzz</a></li>
<li>XML
<ul dir="auto">
<li><a href="https://github.com/google/oss-fuzz/tree/master/projects/xerces-c">https://github.com/google/oss-fuzz/tree/master/projects/xerces-c</a></li>
<li><a href="https://github.com/google/libprotobuf-mutator/tree/master/examples/xml">https://github.com/google/libprotobuf-mutator/tree/master/examples/xml</a></li>
</ul>
</li>
<li>JPEG, <a href="https://source.chromium.org/chromium/chromium/src/+/main:media/gpu/vaapi/fuzzers/jpeg_decoder/" rel="nofollow">https://source.chromium.org/chromium/chromium/src/+/main:media/gpu/vaapi/fuzzers/jpeg_decoder/</a></li>
</ul>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Bugs found with help of the library</h2><a id="user-content-bugs-found-with-help-of-the-library" class="anchor" aria-label="Permalink: Bugs found with help of the library" href="#bugs-found-with-help-of-the-library"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Chromium</h3><a id="user-content-chromium" class="anchor" aria-label="Permalink: Chromium" href="#chromium"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li><a href="http://www.powerofcommunity.net/poc2018/ned.pdf" rel="nofollow">AppCache exploit</a> (<a href="https://bugs.chromium.org/p/chromium/issues/detail?id=888926" rel="nofollow">Actual still restricted bug</a>)</li>
<li><a href="https://bugs.chromium.org/p/chromium/issues/detail?id=777728" rel="nofollow">Stack Buffer Overflow in QuicClientPromisedInfo</a></li>
<li><a href="https://bugs.chromium.org/p/chromium/issues/detail?id=911251" rel="nofollow">null dereference in sqlite3ExprCompare</a></li>
</ul>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Envoy</h3><a id="user-content-envoy" class="anchor" aria-label="Permalink: Envoy" href="#envoy"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li><a href="https://github.com/envoyproxy/envoy/pull/4321" data-hovercard-type="pull_request" data-hovercard-url="/envoyproxy/envoy/pull/4321/hovercard">strftime overflow</a></li>
<li><a href="https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=8028" rel="nofollow">Heap-use-after-free in Envoy::Upstream::SubsetLoadBalancer::updateFallbackSubset</a></li>
<li><a href="https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=11231" rel="nofollow">Heap-use-after-free in Envoy::Secret::SecretManagerImpl</a></li>
<li><a href="https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=10038" rel="nofollow">Heap-buffer-overflow in Envoy::Http::HeaderString</a></li>
</ul>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Related materials</h2><a id="user-content-related-materials" class="anchor" aria-label="Permalink: Related materials" href="#related-materials"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li><a href="https://media.ccc.de/v/35c3-9579-attacking_chrome_ipc" rel="nofollow">Attacking Chrome IPC: Reliably finding bugs to escape the Chrome sandbox</a></li>
<li><a href="https://www.youtube.com/watch?v=U60hC16HEDY" rel="nofollow">Structure-aware fuzzing for Clang and LLVM with libprotobuf-mutator</a></li>
<li><a href="https://github.com/google/fuzzer-test-suite/blob/master/tutorial/structure-aware-fuzzing.md">Structure-Aware Fuzzing with libFuzzer</a></li>
</ul>
</article></div>