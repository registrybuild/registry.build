<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><div class="markdown-heading" dir="auto"><h1 class="heading-element" dir="auto">Benchmark</h1><a id="user-content-benchmark" class="anchor-element" aria-label="Permalink: Benchmark" href="#benchmark"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><a href="https://github.com/google/benchmark/actions?query=workflow%3Abuild-and-test"><img src="https://github.com/google/benchmark/workflows/build-and-test/badge.svg" alt="build-and-test" style="max-width: 100%;"></a>
<a href="https://github.com/google/benchmark/actions/workflows/bazel.yml"><img src="https://github.com/google/benchmark/actions/workflows/bazel.yml/badge.svg" alt="bazel" style="max-width: 100%;"></a>
<a href="https://github.com/google/benchmark/actions?query=workflow%3Apylint"><img src="https://github.com/google/benchmark/workflows/pylint/badge.svg" alt="pylint" style="max-width: 100%;"></a>
<a href="https://github.com/google/benchmark/actions?query=workflow%3Atest-bindings"><img src="https://github.com/google/benchmark/workflows/test-bindings/badge.svg" alt="test-bindings" style="max-width: 100%;"></a>
<a href="https://coveralls.io/r/google/benchmark" rel="nofollow"><img src="https://camo.githubusercontent.com/1f50f235102970efcccf2e973304be6f36e5898c44dafbff20ee4c53112df2ac/68747470733a2f2f636f766572616c6c732e696f2f7265706f732f676f6f676c652f62656e63686d61726b2f62616467652e737667" alt="Coverage Status" data-canonical-src="https://coveralls.io/repos/google/benchmark/badge.svg" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://discord.gg/cz7UX7wKC2" rel="nofollow"><img src="https://camo.githubusercontent.com/7704d382d9575feb722e5b8f562949d1eb6d861339bb3ec1a76fee0ed8e0a8c1/68747470733a2f2f646973636f72646170702e636f6d2f6170692f6775696c64732f313132353639343939353932383731393439342f7769646765742e706e673f7374796c653d736869656c64" alt="Discord" data-canonical-src="https://discordapp.com/api/guilds/1125694995928719494/widget.png?style=shield" style="max-width: 100%;"></a></p>
<p dir="auto">A library to benchmark code snippets, similar to unit tests. Example:</p>
<div class="highlight highlight-source-c++ notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="#include &lt;benchmark/benchmark.h&gt;

static void BM_SomeFunction(benchmark::State&amp; state) {
  // Perform setup here
  for (auto _ : state) {
    // This code gets timed
    SomeFunction();
  }
}
// Register the function as a benchmark
BENCHMARK(BM_SomeFunction);
// Run the benchmark
BENCHMARK_MAIN();"><pre>#<span class="pl-k">include</span> <span class="pl-s"><span class="pl-pds">&lt;</span>benchmark/benchmark.h<span class="pl-pds">&gt;</span></span>

<span class="pl-k">static</span> <span class="pl-k">void</span> <span class="pl-en">BM_SomeFunction</span>(benchmark::State&amp; state) {
  <span class="pl-c"><span class="pl-c">//</span> Perform setup here</span>
  <span class="pl-k">for</span> (<span class="pl-k">auto</span> _ : state) {
    <span class="pl-c"><span class="pl-c">//</span> This code gets timed</span>
    <span class="pl-c1">SomeFunction</span>();
  }
}
<span class="pl-c"><span class="pl-c">//</span> Register the function as a benchmark</span>
BENCHMARK(BM_SomeFunction);
<span class="pl-c"><span class="pl-c">//</span> Run the benchmark</span>
BENCHMARK_MAIN();</pre></div>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Getting Started</h2><a id="user-content-getting-started" class="anchor-element" aria-label="Permalink: Getting Started" href="#getting-started"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">To get started, see <a href="#requirements">Requirements</a> and
<a href="#installation">Installation</a>. See <a href="#usage">Usage</a> for a full example and the
<a href="docs/user_guide.md">User Guide</a> for a more comprehensive feature overview.</p>
<p dir="auto">It may also help to read the <a href="https://github.com/google/googletest/blob/main/docs/primer.md">Google Test documentation</a>
as some of the structural aspects of the APIs are similar.</p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Resources</h2><a id="user-content-resources" class="anchor-element" aria-label="Permalink: Resources" href="#resources"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><a href="https://groups.google.com/d/forum/benchmark-discuss" rel="nofollow">Discussion group</a></p>
<p dir="auto">IRC channels:</p>
<ul dir="auto">
<li><a href="https://libera.chat" rel="nofollow">libera</a> #benchmark</li>
</ul>
<p dir="auto"><a href="docs/tools.md">Additional Tooling Documentation</a></p>
<p dir="auto"><a href="docs/AssemblyTests.md">Assembly Testing Documentation</a></p>
<p dir="auto"><a href="docs/python_bindings.md">Building and installing Python bindings</a></p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Requirements</h2><a id="user-content-requirements" class="anchor-element" aria-label="Permalink: Requirements" href="#requirements"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">The library can be used with C++03. However, it requires C++11 to build,
including compiler and standard library support.</p>
<p dir="auto">The following minimum versions are required to build the library:</p>
<ul dir="auto">
<li>GCC 4.8</li>
<li>Clang 3.4</li>
<li>Visual Studio 14 2015</li>
<li>Intel 2015 Update 1</li>
</ul>
<p dir="auto">See <a href="docs/platform_specific_build_instructions.md">Platform-Specific Build Instructions</a>.</p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Installation</h2><a id="user-content-installation" class="anchor-element" aria-label="Permalink: Installation" href="#installation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">This describes the installation process using cmake. As pre-requisites, you'll
need git and cmake installed.</p>
<p dir="auto"><em>See <a href="docs/dependencies.md">dependencies.md</a> for more details regarding supported
versions of build tools.</em></p>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="# Check out the library.
$ git clone https://github.com/google/benchmark.git
# Go to the library root directory
$ cd benchmark
# Make a build directory to place the build output.
$ cmake -E make_directory &quot;build&quot;
# Generate build system files with cmake, and download any dependencies.
$ cmake -E chdir &quot;build&quot; cmake -DBENCHMARK_DOWNLOAD_DEPENDENCIES=on -DCMAKE_BUILD_TYPE=Release ../
# or, starting with CMake 3.13, use a simpler form:
# cmake -DCMAKE_BUILD_TYPE=Release -S . -B &quot;build&quot;
# Build the library.
$ cmake --build &quot;build&quot; --config Release"><pre><span class="pl-c"><span class="pl-c">#</span> Check out the library.</span>
$ git clone https://github.com/google/benchmark.git
<span class="pl-c"><span class="pl-c">#</span> Go to the library root directory</span>
$ <span class="pl-c1">cd</span> benchmark
<span class="pl-c"><span class="pl-c">#</span> Make a build directory to place the build output.</span>
$ cmake -E make_directory <span class="pl-s"><span class="pl-pds">"</span>build<span class="pl-pds">"</span></span>
<span class="pl-c"><span class="pl-c">#</span> Generate build system files with cmake, and download any dependencies.</span>
$ cmake -E chdir <span class="pl-s"><span class="pl-pds">"</span>build<span class="pl-pds">"</span></span> cmake -DBENCHMARK_DOWNLOAD_DEPENDENCIES=on -DCMAKE_BUILD_TYPE=Release ../
<span class="pl-c"><span class="pl-c">#</span> or, starting with CMake 3.13, use a simpler form:</span>
<span class="pl-c"><span class="pl-c">#</span> cmake -DCMAKE_BUILD_TYPE=Release -S . -B "build"</span>
<span class="pl-c"><span class="pl-c">#</span> Build the library.</span>
$ cmake --build <span class="pl-s"><span class="pl-pds">"</span>build<span class="pl-pds">"</span></span> --config Release</pre></div>
<p dir="auto">This builds the <code>benchmark</code> and <code>benchmark_main</code> libraries and tests.
On a unix system, the build directory should now look something like this:</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="/benchmark
  /build
    /src
      /libbenchmark.a
      /libbenchmark_main.a
    /test
      ..."><pre class="notranslate"><code>/benchmark
  /build
    /src
      /libbenchmark.a
      /libbenchmark_main.a
    /test
      ...
</code></pre></div>
<p dir="auto">Next, you can run the tests to check the build.</p>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="$ cmake -E chdir &quot;build&quot; ctest --build-config Release"><pre>$ cmake -E chdir <span class="pl-s"><span class="pl-pds">"</span>build<span class="pl-pds">"</span></span> ctest --build-config Release</pre></div>
<p dir="auto">If you want to install the library globally, also run:</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="sudo cmake --build &quot;build&quot; --config Release --target install"><pre class="notranslate"><code>sudo cmake --build "build" --config Release --target install
</code></pre></div>
<p dir="auto">Note that Google Benchmark requires Google Test to build and run the tests. This
dependency can be provided two ways:</p>
<ul dir="auto">
<li>Checkout the Google Test sources into <code>benchmark/googletest</code>.</li>
<li>Otherwise, if <code>-DBENCHMARK_DOWNLOAD_DEPENDENCIES=ON</code> is specified during
configuration as above, the library will automatically download and build
any required dependencies.</li>
</ul>
<p dir="auto">If you do not wish to build and run the tests, add <code>-DBENCHMARK_ENABLE_GTEST_TESTS=OFF</code>
to <code>CMAKE_ARGS</code>.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Debug vs Release</h3><a id="user-content-debug-vs-release" class="anchor-element" aria-label="Permalink: Debug vs Release" href="#debug-vs-release"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">By default, benchmark builds as a debug library. You will see a warning in the
output when this is the case. To build it as a release library instead, add
<code>-DCMAKE_BUILD_TYPE=Release</code> when generating the build system files, as shown
above. The use of <code>--config Release</code> in build commands is needed to properly
support multi-configuration tools (like Visual Studio for example) and can be
skipped for other build systems (like Makefile).</p>
<p dir="auto">To enable link-time optimisation, also add <code>-DBENCHMARK_ENABLE_LTO=true</code> when
generating the build system files.</p>
<p dir="auto">If you are using gcc, you might need to set <code>GCC_AR</code> and <code>GCC_RANLIB</code> cmake
cache variables, if autodetection fails.</p>
<p dir="auto">If you are using clang, you may need to set <code>LLVMAR_EXECUTABLE</code>,
<code>LLVMNM_EXECUTABLE</code> and <code>LLVMRANLIB_EXECUTABLE</code> cmake cache variables.</p>
<p dir="auto">To enable sanitizer checks (eg., <code>asan</code> and <code>tsan</code>), add:</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content=" -DCMAKE_C_FLAGS=&quot;-g -O2 -fno-omit-frame-pointer -fsanitize=address -fsanitize=thread -fno-sanitize-recover=all&quot;
 -DCMAKE_CXX_FLAGS=&quot;-g -O2 -fno-omit-frame-pointer -fsanitize=address -fsanitize=thread -fno-sanitize-recover=all &quot;  "><pre class="notranslate"><code> -DCMAKE_C_FLAGS="-g -O2 -fno-omit-frame-pointer -fsanitize=address -fsanitize=thread -fno-sanitize-recover=all"
 -DCMAKE_CXX_FLAGS="-g -O2 -fno-omit-frame-pointer -fsanitize=address -fsanitize=thread -fno-sanitize-recover=all "  
</code></pre></div>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Stable and Experimental Library Versions</h3><a id="user-content-stable-and-experimental-library-versions" class="anchor-element" aria-label="Permalink: Stable and Experimental Library Versions" href="#stable-and-experimental-library-versions"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">The main branch contains the latest stable version of the benchmarking library;
the API of which can be considered largely stable, with source breaking changes
being made only upon the release of a new major version.</p>
<p dir="auto">Newer, experimental, features are implemented and tested on the
<a href="https://github.com/google/benchmark/tree/v2"><code>v2</code> branch</a>. Users who wish
to use, test, and provide feedback on the new features are encouraged to try
this branch. However, this branch provides no stability guarantees and reserves
the right to change and break the API at any time.</p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Usage</h2><a id="user-content-usage" class="anchor-element" aria-label="Permalink: Usage" href="#usage"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Basic usage</h3><a id="user-content-basic-usage" class="anchor-element" aria-label="Permalink: Basic usage" href="#basic-usage"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Define a function that executes the code to measure, register it as a benchmark
function using the <code>BENCHMARK</code> macro, and ensure an appropriate <code>main</code> function
is available:</p>
<div class="highlight highlight-source-c++ notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="#include &lt;benchmark/benchmark.h&gt;

static void BM_StringCreation(benchmark::State&amp; state) {
  for (auto _ : state)
    std::string empty_string;
}
// Register the function as a benchmark
BENCHMARK(BM_StringCreation);

// Define another benchmark
static void BM_StringCopy(benchmark::State&amp; state) {
  std::string x = &quot;hello&quot;;
  for (auto _ : state)
    std::string copy(x);
}
BENCHMARK(BM_StringCopy);

BENCHMARK_MAIN();"><pre>#<span class="pl-k">include</span> <span class="pl-s"><span class="pl-pds">&lt;</span>benchmark/benchmark.h<span class="pl-pds">&gt;</span></span>

<span class="pl-k">static</span> <span class="pl-k">void</span> <span class="pl-en">BM_StringCreation</span>(benchmark::State&amp; state) {
  <span class="pl-k">for</span> (<span class="pl-k">auto</span> _ : state)
    std::string empty_string;
}
<span class="pl-c"><span class="pl-c">//</span> Register the function as a benchmark</span>
BENCHMARK(BM_StringCreation);

<span class="pl-c"><span class="pl-c">//</span> Define another benchmark</span>
static <span class="pl-k">void</span> <span class="pl-en">BM_StringCopy</span>(benchmark::State&amp; state) {
  std::string x = <span class="pl-s"><span class="pl-pds">"</span>hello<span class="pl-pds">"</span></span>;
  <span class="pl-k">for</span> (<span class="pl-k">auto</span> _ : state)
    std::string <span class="pl-smi">copy</span>(x);
}
<span class="pl-en">BENCHMARK</span>(BM_StringCopy);

<span class="pl-en">BENCHMARK_MAIN</span>();</pre></div>
<p dir="auto">To run the benchmark, compile and link against the <code>benchmark</code> library
(libbenchmark.a/.so). If you followed the build steps above, this library will
be under the build directory you created.</p>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="# Example on linux after running the build steps above. Assumes the
# `benchmark` and `build` directories are under the current directory.
$ g++ mybenchmark.cc -std=c++11 -isystem benchmark/include \
  -Lbenchmark/build/src -lbenchmark -lpthread -o mybenchmark"><pre><span class="pl-c"><span class="pl-c">#</span> Example on linux after running the build steps above. Assumes the</span>
<span class="pl-c"><span class="pl-c">#</span> `benchmark` and `build` directories are under the current directory.</span>
$ g++ mybenchmark.cc -std=c++11 -isystem benchmark/include \
  -Lbenchmark/build/src -lbenchmark -lpthread -o mybenchmark</pre></div>
<p dir="auto">Alternatively, link against the <code>benchmark_main</code> library and remove
<code>BENCHMARK_MAIN();</code> above to get the same behavior.</p>
<p dir="auto">The compiled executable will run all benchmarks by default. Pass the <code>--help</code>
flag for option information or see the <a href="docs/user_guide.md">User Guide</a>.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Usage with CMake</h3><a id="user-content-usage-with-cmake" class="anchor-element" aria-label="Permalink: Usage with CMake" href="#usage-with-cmake"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">If using CMake, it is recommended to link against the project-provided
<code>benchmark::benchmark</code> and <code>benchmark::benchmark_main</code> targets using
<code>target_link_libraries</code>.
It is possible to use <code>find_package</code> to import an installed version of the
library.</p>
<div class="highlight highlight-source-cmake notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="find_package(benchmark REQUIRED)"><pre><span class="pl-c1">find_package</span>(benchmark <span class="pl-k">REQUIRED</span>)</pre></div>
<p dir="auto">Alternatively, <code>add_subdirectory</code> will incorporate the library directly in
to one's CMake project.</p>
<div class="highlight highlight-source-cmake notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="add_subdirectory(benchmark)"><pre><span class="pl-c1">add_subdirectory</span>(benchmark)</pre></div>
<p dir="auto">Either way, link to the library as follows.</p>
<div class="highlight highlight-source-cmake notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="target_link_libraries(MyTarget benchmark::benchmark)"><pre><span class="pl-c1">target_link_libraries</span>(MyTarget benchmark::benchmark)</pre></div>
</article></div>