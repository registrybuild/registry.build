<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><div class="markdown-heading" dir="auto"><h1 class="heading-element" dir="auto">buildozer</h1><a id="user-content-buildozer" class="anchor" aria-label="Permalink: buildozer" href="#buildozer"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">This Bazel module provides a pinned, prebuilt version of <a href="https://github.com/bazelbuild/buildtools/blob/master/buildozer/README.md">buildozer</a>, a tool for manipulating Bazel BUILD files.</p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Requirements</h2><a id="user-content-requirements" class="anchor" aria-label="Permalink: Requirements" href="#requirements"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li>Bazel 6.5.0 or later</li>
</ul>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Usage</h2><a id="user-content-usage" class="anchor" aria-label="Permalink: Usage" href="#usage"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ol dir="auto">
<li>Add the following line to your <code>MODULE.bazel</code> file:</li>
</ol>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="bazel_dep(name = &quot;buildozer&quot;, version = &quot;8.2.1&quot;, dev_dependency = True)"><pre><span class="pl-en">bazel_dep</span>(<span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"buildozer"</span>, <span class="pl-s1">version</span> <span class="pl-c1">=</span> <span class="pl-s">"8.2.1"</span>, <span class="pl-s1">dev_dependency</span> <span class="pl-c1">=</span> <span class="pl-c1">True</span>)</pre></div>
<ol start="2" dir="auto">
<li>Run buildozer via <code>bazel run</code>:</li>
</ol>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="bazel run @buildozer -- ..."><pre>bazel run @buildozer -- ...</pre></div>
<p dir="auto">The <code>--</code> is optional if you don't need to pass arguments to buildozer that start with a dash.</p>
<p dir="auto">You can also create an <code>alias</code> for the <code>@buildozer</code> target in your main repo.</p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Using buildozer in repository rules and module extensions</h2><a id="user-content-using-buildozer-in-repository-rules-and-module-extensions" class="anchor" aria-label="Permalink: Using buildozer in repository rules and module extensions" href="#using-buildozer-in-repository-rules-and-module-extensions"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">You can also use buildozer in a repository rule or module extension, i.e., during the loading phase:</p>
<ol dir="auto">
<li>Add the following line to your <code>MODULE.bazel</code> file:</li>
</ol>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="bazel_dep(name = &quot;buildozer&quot;, version = &quot;8.2.1&quot;)"><pre><span class="pl-en">bazel_dep</span>(<span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"buildozer"</span>, <span class="pl-s1">version</span> <span class="pl-c1">=</span> <span class="pl-s">"8.2.1"</span>)</pre></div>
<ol start="2" dir="auto">
<li>In your repository rule or module extension implementation function, get the path to the buildozer binary as follows:</li>
</ol>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="load(&quot;@buildozer//:buildozer.bzl&quot;, &quot;BUILDOZER_LABEL&quot;)
...
def my_impl(repository_or_module_ctx):
    buildozer = repository_or_module_ctx.path(BUILDOZER_LABEL)
    ...
    repository_or_module_ctx.execute(
        [buildozer, 'set foo bar', '//path/to/pkg:target']
    )"><pre><span class="pl-en">load</span>(<span class="pl-s">"@buildozer//:buildozer.bzl"</span>, <span class="pl-s">"BUILDOZER_LABEL"</span>)
...
<span class="pl-k">def</span> <span class="pl-en">my_impl</span>(<span class="pl-s1">repository_or_module_ctx</span>):
    <span class="pl-s1">buildozer</span> <span class="pl-c1">=</span> <span class="pl-s1">repository_or_module_ctx</span>.<span class="pl-c1">path</span>(<span class="pl-c1">BUILDOZER_LABEL</span>)
    ...
    <span class="pl-s1">repository_or_module_ctx</span>.<span class="pl-c1">execute</span>(
        [<span class="pl-s1">buildozer</span>, <span class="pl-s">'set foo bar'</span>, <span class="pl-s">'//path/to/pkg:target'</span>]
    )</pre></div>
<p dir="auto">Keep the <code>path</code> call at the top of your implementation function as it may cause a <a href="https://bazel.build/extending/repo#restarting_the_implementation_function" rel="nofollow">restart of the repository rule</a>.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Alternative usage</h3><a id="user-content-alternative-usage" class="anchor" aria-label="Permalink: Alternative usage" href="#alternative-usage"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">If you dont want to or can't <code>load</code> from <code>@buildozer</code>, you can also use the following approach:</p>
<ol dir="auto">
<li>Add the following lines to your <code>MODULE.bazel</code> file:</li>
</ol>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="bazel_dep(name = &quot;buildozer&quot;, version = &quot;8.2.1&quot;)

buildozer_binary = use_extension(&quot;@buildozer//:buildozer_binary.bzl&quot;, &quot;buildozer_binary&quot;)
use_repo(buildozer_binary, &quot;buildozer_binary&quot;)"><pre><span class="pl-en">bazel_dep</span>(<span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"buildozer"</span>, <span class="pl-s1">version</span> <span class="pl-c1">=</span> <span class="pl-s">"8.2.1"</span>)

<span class="pl-s1">buildozer_binary</span> <span class="pl-c1">=</span> <span class="pl-en">use_extension</span>(<span class="pl-s">"@buildozer//:buildozer_binary.bzl"</span>, <span class="pl-s">"buildozer_binary"</span>)
<span class="pl-en">use_repo</span>(<span class="pl-s1">buildozer_binary</span>, <span class="pl-s">"buildozer_binary"</span>)</pre></div>
<ol start="2" dir="auto">
<li>In your repository rule or module extension implementation function, get the path to the buildozer binary as follows:</li>
</ol>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="def my_impl(repository_or_module_ctx):
    # The &quot;.exe&quot; suffix is *not* a typo. It is present on all platforms to support
    # Windows while maintaining a stable label.
    buildozer = repository_or_module_ctx.path(Label(&quot;@buildozer_binary//:buildozer.exe&quot;))"><pre><span class="pl-k">def</span> <span class="pl-en">my_impl</span>(<span class="pl-s1">repository_or_module_ctx</span>):
    <span class="pl-c"># The ".exe" suffix is *not* a typo. It is present on all platforms to support</span>
    <span class="pl-c"># Windows while maintaining a stable label.</span>
    <span class="pl-s1">buildozer</span> <span class="pl-c1">=</span> <span class="pl-s1">repository_or_module_ctx</span>.<span class="pl-c1">path</span>(<span class="pl-en">Label</span>(<span class="pl-s">"@buildozer_binary//:buildozer.exe"</span>))</pre></div>
</article></div>